var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};window.$app.defineComponent("frontend","vue-frontend-actionbar",{data:function(){return{page:"",data:null,isOpenModal:!1,isAdding:!1,isAllowStart:null,isAllowEnd:null}},created:function(){var i=this;this.page=this.getPagePart(),window.$events.on("beforeNavigate",function(e,t){i.page=null}),window.$events.on("navigate",function(e,t){i.page=i.getPagePart(),i.data=null}),window.$events.on("setpage",function(e,t){i.data=t}),this.updateAllows(this.isAllow)},watch:{isAllow:function(e){this.updateAllows(e)}},computed:{disabled:function(){return null!=this.$account.readonly&&this.$account.readonly},isAllow:function(){var e=-1==["product","checkout"].indexOf(this.page),t="part"!=this.page&&this.$auth.isAllowTariff("business")&&(e&&0<this.$actionbar.info.basket.amount||!e);return $mx("body").toggleClass("has-actionbar",t),t},checkoutButtonTitle:function(){return[this.$gettext("Оформить заказ"),this.$gettext("Подтвердить"),this.data?this.data.button:null][this.data?this.data.step:0]}},methods:{updateAllows:function(e){var t=this;null==this.isAllowStart?this.isAllowStart=this.isAllowEnd=e:e?(this.isAllowStart=e,setTimeout(function(){t.isAllowEnd=e},300)):(this.isAllowEnd=e,setTimeout(function(){t.isAllowStart=e},300))},getPagePart:function(e){var t,i=(e=e||this.$router.currentRoute).name;return"part"!=i&&"part.index"!=i||null!=(t={o:"product",b:"checkout",m:"storefront"})[e.params.part]&&(i=t[e.params.part]),i},addToCart:function(){var s=this,e=this.data.offer_id;this.data.options_selected.length&&(e+="-"+this.data.options_selected.join("-")),this.isAdding=!0,this.$actionbar.addToCart(e,1).then(function(e){var i;s.isAdding=!1,"success"==e.result&&(i={},_.each(s.data.options,function(e,t){-1!=s.data.options_selected.indexOf(t)&&(i[t]=e)}),$events.fire("addToCart",{product_id:parseInt(s.data.product_id,16),options:i,product:s.data.product,currency:s.$account.currency.code,event_id:e.response.event_id}),$events.fire("products:clearform"),s.isOpenModal=!0)})},toBasket:function(){this.isOpenModal=!1,this.$router.push({name:"part.index",params:{part:"b"}})},marketAction:function(){if(null!=window.fbq)switch(this.data.step){case 0:$events.fire("openCart")}this.data.action()},backToCatalog:function(){"storefront"==this.getPagePart(this.$history.prev)?this.$router.go(-1):this.$router.push({name:"part.index",params:{part:"m"}})}},template:'<div> <div class="action-panel-container" :class="{in: isAllowEnd}" v-if="isAllowStart"> <div class="action-panel"> <div class="page-container"> <div v-if="[\'product\', \'checkout\'].indexOf(page) == -1 && $actionbar.info.basket.amount> 0"> <div class="row row-small"> <div class="col-xs-12 col-sm-8 col-sm-offset-2 col-md-6 col-md-offset-3"> <router-link :to="{name: \'part.index\', params: {part: \'b\'}}" class="button is-medium is-light is-fullwidth"><span class="is-basket-icon with-text" :data-value="$actionbar.info.basket.amount"><i></i><span>{{\'Корзина\'|gettext}}</span></span></router-link> </div> </div> </div> <div v-if="page == \'product\'"> <div class="row row-small" v-if="data && data.data.hide_checkout == 0"> <div class="col-xs-2 col-sm-3"> <a @click.prevent="backToCatalog()" class="button is-medium is-light is-fullwidth has-text-centered product-back-catalog"><i class="fai fa-th"></i></a> </div> <div class="col-xs-8 col-sm-6"> <button type="button" @click="addToCart" class="button is-medium is-primary is-fullwidth" :class="{disabled: !data || !data.product.is_sellable || !data.offer_id || !data.availability, \'is-loading\': isAdding}">{{\'Добавить в корзину\'|gettext}}</button> </div> <div class="col-xs-2 col-sm-3"> <router-link :to="{name: \'part.index\', params: {part: \'b\'}}" class="button is-medium is-light is-fullwidth"><span class="is-basket-icon" :data-value="$actionbar.info.basket.amount?$actionbar.info.basket.amount:null"><i></i></span></router-link> </div> </div> <div v-else class="row row-small"> <div class="col-xs-12 col-sm-8 col-sm-offset-2 col-md-6 col-md-offset-3"> <a @click.prevent="backToCatalog()" class="button is-medium is-light is-fullwidth has-text-centered"><i class="fai fa-th"></i></a> </div> </div> </div> <div v-if="page == \'checkout\'"> <div class="row row-small"> <div class="col-xs-3 col-sm-6"> <a @click.prevent="backToCatalog()" class="button is-medium is-light is-fullwidth has-text-centered"><i class="fai fa-th"></i><span class="is-hidden-mobile has-ml-1"> {{\'Вернуться в каталог\'|gettext}}</span></a> </div> <div class="col-xs-9 col-sm-6"> <button type="button" class="button is-medium is-primary is-fullwidth" :class="{\'is-loading\': data && data.isFetching}" :disabled="!data || !data.isAllowAction || disabled" @click="marketAction">{{checkoutButtonTitle}}</button> </div> </div> </div> </div> </div> </div> <mx-modal :active.sync="isOpenModal" :has-modal-card="true" :can-cancel="[\'outside\']" class="modal-bottom"> <div class="modal-card modal-card-little" style="justify-content: flex-end;padding: 0"> <section class="modal-card-body"> <div class="media"> <div class="media-left" style="align-self: center"> <div class="sa-icon sa-success animate" style="display: block;"> <span class="sa-line sa-tip animateSuccessTip"></span> <span class="sa-line sa-long animateSuccessLong"></span> <div class="sa-placeholder"></div> <div class="sa-fix"></div> </div> </div> <div class="media-content has-text-black" style="align-self: center"> <h2>{{\'Товар добавлен в корзину\'|gettext}}</h2> </div> </div> <button class="button is-medium is-fullwidth is-primary has-mb-2" @click="toBasket">{{\'Перейти в корзину\'|gettext}}</button> <button class="button is-medium is-fullwidth is-light has-mb-2" @click="isOpenModal = false">{{\'Продолжить покупки\'|gettext}}</button> </section> </div> </mx-modal> </div>'}),window.$app.defineComponent("frontend","vue-frontend-addons-agreement-banner",{data:function(){return{isOpenAgreement:!1,isLoading:!1,isClosed:!1,policyIndex:0,policy:[]}},props:["value"],methods:{click:function(e){var t,i=this;"A"==e.target.tagName.toUpperCase()&&"_blank"==e.target.getAttribute("target")||(e.preventDefault(),e.target&&"A"==e.target.tagName.toUpperCase()&&(this.isOpenAgreement=!0,null==this.policy[0]&&(this.policy[0]="",t=(t=e.target.getAttribute("data-endpoint-params"))?JSON.parse(t):{},this.$api.get(e.target.getAttribute("data-endpoint"),{params:Object.assign(t,{index:0,request:"body"})}).then(function(e){i.$set(i.policy,0,e.response.body),i.isLoading=!1}))))}},template:'<div> <div class="footer-banner cookie-banner has-rtl" :class="{\'is-closed\': value.isClosed}" @click="click"> <div class="container has-mb-2 has-mt-2"> <div v-html="value.message"></div> </div> </div> <mx-modal :active.sync="isOpenAgreement" :has-modal-card="true"> <div class="modal-card has-text-black" style="font-size: 1rem" v-if="isOpenAgreement"> <header class="modal-card-head"><p class="modal-card-title">{{\'Юридическая информация\'|gettext}}</p> <button type="button" class="modal-close is-large" @click="isOpenAgreement = false"></button></header> <section class="modal-card-body"> <div class="border col-xs-12" v-if="isLoading"><div class="loading-overlay loading-block is-active"><div class="loading-icon"></div></div></div> <div v-html="policy[policyIndex]"></div> </section> <div class="modal-card-foot"> <button type="button" class="button is-dark" @click="isOpenAgreement = false">{{\'Закрыть\'|gettext}}</button> </div> </div> </mx-modal> </div>'}),window.$app.defineComponent("frontend","vue-frontend-addons-cookiepolicy-banner",{data:function(){return{cookieAgree:!1,isOpenPolicy:!1,isLoading:!1,policyIndex:0,policy:[]}},props:["value"],created:function(){this.cookieAgree=!!Storage.get("cookie_privacy."+this.$account.profile_id,0),null==this.value.titles&&(this.value.titles=[this.value.title])},methods:{agreeCookie:function(){Storage.set("cookie_privacy."+this.$account.profile_id,1,86400),this.cookieAgree=!0},click:function(e){var t,i,s=this;"A"==e.target.tagName.toUpperCase()&&"_blank"==e.target.getAttribute("target")||(e.preventDefault(),e.target&&"A"==e.target.tagName.toUpperCase()&&(this.isOpenPolicy=!0,t=/\/a\/cookiepolicy\/([0-9]+)\//.exec(e.target.href),i=parseInt(t&&null!=t[1]?t[1]:0),this.policyIndex=i,null==this.policy[i]&&(this.policy[i]="",this.$api.get("addon/resolve",{params:{addon:"cookiepolicy",request:"body",params:{index:i}}}).then(function(e){s.$set(s.policy,i,e.response.body),s.isLoading=!1}))))}},template:'<div> <div class="footer-banner cookie-banner has-rtl" :class="{\'is-closed\': cookieAgree}" @click="click"> <div class="container has-mb-2 has-mt-2"> <div v-html="value.message"></div> <button class="button is-dark is-hidden-touch" @click="agreeCookie">{{\'Я понял\'|gettext}}</button> <button class="modal-close is-large is-hidden-desktop" @click="agreeCookie"></button> </div> </div> <mx-modal :active.sync="isOpenPolicy" :has-modal-card="true"> <div class="modal-card has-text-black" style="font-size: 1rem" v-if="isOpenPolicy"> <header class="modal-card-head"><p class="modal-card-title">{{value.titles[policyIndex]|gettext}}</p> <button type="button" class="modal-close is-large" @click="isOpenPolicy = false"></button></header> <section class="modal-card-body"> <div class="border col-xs-12" v-if="isLoading"><div class="loading-overlay loading-block is-active"><div class="loading-icon"></div></div></div> <div v-html="policy[policyIndex]"></div> </section> <div class="modal-card-foot"> <button type="button" class="button is-dark" @click="isOpenPolicy = false">{{\'Закрыть\'|gettext}}</button> </div> </div> </mx-modal> </div>'}),window.$app.defineComponent("frontend","vue-frontend-blocks-auth",{data:function(){return{isChecking:!1,error:"",fields:[{type_id:6,title:"Email",text:"",required:!0,idx:"1",typename:"email"},{type_id:0,title:"Password",text:"",required:!0,idx:"2",typename:"password"},{title:"Войти",typename:"button"}]}},props:["options","block_id","page_id","part"],methods:{apply:function(){var t=this,e=this.$refs.form.getFields(),i={};_.each(e,function(e){i[0==e.type?"password":"login"]=e.value}),this.isChecking=!0,this.$api.post("auth/check",{params:_.merge(i,{part:this.part,id:this.page_id})}).then(function(e){"success"==e.result?t.$emit("refreshPage"):null!=e.message&&alert(e.message),t.isChecking=!1})}},template:'<div class="block-auth"> <form @submit.prevent="apply" class="block-form"> <vue-frontend-form-elements :fields="fields" ref="form" :isLoading="isChecking"/> </form> </div>'}),window.$app.defineComponent("frontend","vue-frontend-blocks-avatar",{props:{index:{type:Number,default:0},mode:{default:"view"},account:Object,data:Object},computed:{style:function(){return 0==this.index?"":"visibility:hidden"},backLink:function(){return this.$history.stackBack.length<2?"":this.$history.stackBack[this.$history.stackBack.length-2].path},to:function(){return this.data&&2==this.data.avatar_link_storefront?{name:"part.index",params:{part:"m"}}:{name:"index"}}},methods:{click:function(){"view"==this.mode&&this.$router.push(this.to)}},template:'<div> <div class="block-avatar block-avatar-history"> <div> <router-link class="fai fa-chevron-left avatar-history is-left has-p-2" style="padding-left:0 !important" :to="backLink" :class="{\'is-hide\': $history.stackBack.length < 2}" :style="style" v-if="mode == \'view\'"></router-link> </div> <component v-bind:is="(mode == \'view\')?\'a\':\'div\'" @click.prevent="click" :href="$router.resolve(to).href"> <div class="has-text-centered"><img :src="\'//{1}{2}\'|format(account.storage_domain, account.avatar.url)" :class="\'profile-avatar profile-avatar-{1}\'|format(account.avatar.size)" :alt="account.nickname"></div> </component> <div> <i class="fai fa-chevron-right avatar-history has-p-2" style="padding-right:0 !important;visibility:hidden" @click="$router.go(1)" v-if="mode == \'view\'"></i> </div> </div> <div class="has-text-centered text-avatar" v-if="!account.avatar.is_hide_text && account.has_nickname">{{account.nickname}}</div> </div>'}),window.$app.defineComponent("frontend","vue-frontend-blocks-banner",{data:function(){return{defaults:{link:{title:"",type:"link",value:""},p:null,is_link:!1,is_scale:!1,is_stretch:!1,is_marginless:!1,width:""}}},props:{options:Object,block:Object,page_id:Number,mode:{default:"view"}},mixins:[BlockModel],created:function(){this.block.tariff="pro"},computed:{classnames:function(){return{"picture-container-empty":!this.values.p,lazy:this.values.p,"lazy-force":"edit"==this.mode}},style:function(){return"padding-top: "+(this.values.p?this.values.p.height/this.values.p.width*100:50)+"%"+(this.values.p?";background: 0 0 / 100% no-repeat":"")},backgroundImage:function(){var e=this.values.p;return e?"string"==typeof e&&-1!=e.indexOf("://")?e:"//"+this.$account.storage_domain+"/p/"+e.filename:null},bannerInnerStyle:function(){var e=this.values;return e.p&&!e.is_stretch?"width:"+(e.is_scale&&e.width?e.width:e.p.width)+"px":""}},methods:{isExternal:function(e){return-1!=["link","phone","sms","email",""].indexOf(e.type)},link:function(e){return this.$links.resolve(e)},click:function(e){var t=this.values,i=this.$links.resolve(t.link);_.isObject(i)||"#"!=i.substr(0,1)?(i=_.isObject(i)?this.$router.resolve(i).href:i,window.$events.fire("tap",{page_id:this.page_id,block_id:this.block.block_id,stat:this.block.block_id+"."+this.block.stat,data:[{event:"taplink:"+t.link.type,param:i}],addons:null!=this.values.data&&null!=this.values.data.link?this.values.data.link:null}),this.isExternal(t.link)||e.preventDefault()):$mx('[name="'+i.substr(1)+'"]').scrollIt(500)}},template:'<div :class="{\'is-marginless\': values.is_marginless && values.is_stretch}"> <div v-if="values.is_link && (mode != \'edit\')"> <a v-if="isExternal(values.link)" rel="noopener" :target="(options.open_new_window || $account.open_new_window)?\'_blank\':\'_top\'" :href=\'link(values.link)\' @click="click"><div class="block-banner-inner" :style="bannerInnerStyle"><div class="picture-container" :class="classnames" :data-src="backgroundImage" :style="style"></div></div></a> <router-link v-else rel="noopener" :to=\'link(values.link)\' @click.native="click(values)"><div class="block-banner-inner" :style="bannerInnerStyle"><div class="picture-container" :class="classnames" :style="style" :data-src="backgroundImage"></div></div></router-link> </div> <div v-else> <div class="block-banner-inner" :style="bannerInnerStyle"><div class="picture-container" :class="classnames" :style="style" :data-src="backgroundImage"></div></div> </div> </div>'}),window.$app.defineComponent("frontend","vue-frontend-blocks-break",{data:function(){return{defaults:{break_size:30,icon:0,fullwidth:!1,fading:!1},keyComponent:0}},props:["options"],mixins:[BlockModel],watch:{values:function(){}},methods:{icon:function(e){var t=this;if(!e||-1==e)return null;var i={1:"tabler/circle",2:"tabler/square-rotated",3:"legacy/wave-triangle",4:"legacy/wave-sine",5:"legacy/chevron-double-down",6:"legacy/chevron-down",7:"tabler/star"};return null!=i[e]&&(e=i[e]),this.$icons.get(e,function(){t.keyComponent++})}},template:"<div class='block-break' :key=\"keyComponent\"><div class='block-break-inner' :class=\"{'has-icon': values.icon, 'is-invisible': values.icon < 0, 'is-fullwidth': values.fullwidth, 'has-fading': values.fading}\" :style=\"{'height': values.break_size + 'px', margin: (values.icon == -1)?'-7px 0':null}\"><span v-html=\"icon(values.icon)\"> </span></div>"}),window.$app.defineComponent("frontend","vue-frontend-blocks-collapse",{data:function(){return{defaults:{fields:[]}}},props:{options:Object,mode:{default:"view"}},mixins:[BlockModel],created:function(){this.prepareCollapsed()},watch:{values:function(){this.prepareCollapsed()}},methods:{prepareCollapsed:function(){this.$set(this.values,"collapsed",Array(this.values.fields.length).fill(!1))},toggle:function(e){this.$set(this.values.collapsed,e,!this.values.collapsed[e]),this.$parent.$emit("checkHeight")}},template:'<div class="block-form has-rtl"> <div ref=\'styles\'></div> <div class="collapse-list"> <div v-for="(f, i) in values.fields" class="collapse-item" :class="{in: values.collapsed[i]}"> <div class="a" @click="toggle(i)" style="cursor: pointer"> <span class="collapse-icon"></span> <span class="collapse-title" v-if="f.title" v-html="$typography(f.title)"></span> <span class="collapse-title" v-else>{{\'Заголовок\'|gettext}}</span> </div> <div class="collapse-text"><div class="collapse-text-inner" v-html="$parseContacts($typography(f.text), (mode == \'view\')?\'a\':\'span\')"></div></div> </div> </div> </div>'}),window.$app.defineComponent("frontend","vue-frontend-blocks-courses-feed",{data:function(){return{isFetching:!0,defaults:{colors:{bg:"#ffffff",text:"#000000"}}}},props:["options","page_id","block"],mixins:[BlockModel],created:function(){this.fetchData(),this.block.tariff="business"},computed:{stylesheets:function(){var e=_.merge({colors:{bg:"#ffffff",text:"#000000"}},this.options,!0);return{background:e.colors.bg,color:e.colors.text,"--color-text":e.colors.text}}},methods:{fetchData:function(){var t=this;this.options.lessons=[{title:"AAAAA",subtitle:"AAAAAAA",lesson_id:0},{title:"AAAAAAAA",subtitle:"AAAAAAAAAAA",lesson_id:0},{title:"AAAAA",subtitle:"AAAA",lesson_id:0},{title:"AAAAAAAAAAA",subtitle:"AAAAAAA",lesson_id:0}],this.$api.get("addon/resolve",{params:{addon:"courses",request:"feed",params:{id:this.page_id}}}).then(function(e){"success"==e.result?(t.$set(t.options,"lessons",e.response.lessons),window.$events.fire("courses:data",{data:e.response.data}),t.isFetching=!1):"unauthorized"==e.result&&t.$emit("refreshPage")})}},template:'<div class="block-course has-rtl" :style="stylesheets"> <div :class="{disabled: isFetching}"> <router-link :to="{name: \'part\', params: {part: \'f\', page_id: l.lesson_id.toString(16)}}" v-for="l in options.lessons" class="course-lesson" :data-status="l.status"> <div><b :class="{\'is-fetching-block\': isFetching}">{{l.title}}</b><br><span style="font-size: 90%;opacity: .6" :class="{\'is-fetching-block\': isFetching}">{{l.subtitle}}</span></div> </router-link> </div> </div>'}),window.$app.defineComponent("frontend","vue-frontend-blocks-courses-lesson",{data:function(){return{isFetching:!0,isUpdating:!1,defaults:{colors:{bg:"#ffffff",text:"#000000"},buttons:{done:{bg:"#257942",color:"#ffffff",title:"Отметить как выполненное"}}}}},props:["options","page_id","block"],mixins:[BlockModel],created:function(){this.fetchData(),this.block.tariff="business"},computed:{o:function(){return _.merge({colors:{bg:"#ffffff",text:"#000000"},buttons:{done:{bg:"#257942",color:"#ffffff",title:"Отметить как выполненное"}}},this.options,!0)},stylesheetsBody:function(){var e=this.o.colors;return{background:e.bg,color:e.text}},stylesheetsButton:function(){var e=this.o.buttons.done;return{background:e.bg,borderColor:e.bg,color:e.color,"--color-text":e.color,"padding-right":"6px"}},thumb:function(){return'<div class="is-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24" data-mode="stroke" stroke-width="1" stroke="#000" fill="none" stroke-linecap="round" stroke-linejoin="round"><path d="M5 12l5 5L20 7"/></svg></div>'}},methods:{fetchData:function(){var t=this;this.$api.get("addon/resolve",{params:{addon:"courses",request:"lesson",params:{id:this.page_id}}}).then(function(e){"success"==e.result?(t.$set(t.options,"body",e.response.body),t.$set(t.options,"status",e.response.status),window.$events.fire("courses:data",{data:e.response.data}),t.isFetching=!1):"unauthorized"==e.result&&t.$emit("refreshPage")})},done:function(){var t=this;this.isUpdating=!0,this.$api.post("addon/resolve",{params:{addon:"courses",request:"lesson.done",params:{id:this.page_id}}}).then(function(e){"success"==e.result&&t.$router.push({name:"part",params:{part:"c",page_id:e.response.course_id.toString(16)}})})}},template:'<div> <div class="block-lesson has-rtl" :class="{\'is-fetching-block\': isFetching}" :style="stylesheetsBody"> <div class="courses-lesson-done" v-if="options.status == \'done\'">Задание выполнено</div> <vue-frontend-components-document v-if="options.body" v-model="options.body" class="has-p-2"/> </div> <div class="block-link" :class="{\'is-fetching-block\': isFetching}" v-if="options.status == \'new\'"> <a class="button btn-link with-thumb" :class="{\'is-loading\': isUpdating}" @click="done" :style="stylesheetsButton"><figure class="thumb" v-html="thumb" v-if="thumb"></figure><div class="has-text-left"><div class="btn-link-title">{{o.buttons.done.title}}</div></div></a> </div> </div>'}),window.$app.defineComponent("frontend","vue-frontend-blocks-courses-navs",{data:function(){return{isFetching:!0,data:{menu:{items:[{title:"AAAAA"},{title:"AAAAAAAA"}]}},defaults:{colors:{bg:"#ffffff",text:"#000000"}}}},props:["options","page_id","block"],mixins:[BlockModel],computed:{o:function(){return _.merge(this.defaults,this.options,!0)},stylesheets:function(){var e=this.o.colors;return{background:e.bg,color:e.text,"--color-text":e.text}}},created:function(){var i=this;window.$events.on("courses:data",function(e,t){i.data=t.data,i.isFetching=!1}),this.block.tariff="business"},template:'<div class="block-course-navs has-rtl has-mb-1" :style="stylesheets"> <div v-for="f in data.menu.items"><router-link :to="f.link" v-if="f.link">{{f.title}}</router-link><span v-else :class="{\'is-fetching-block\': isFetching}">{{f.title}}</span></div> </div>'}),window.$app.defineComponent("frontend","vue-frontend-blocks-courses-progress",{data:function(){return{isFetching:!0,data:null,defaults:{colors:{done:"#49c674"}}}},props:["options","page_id","block"],mixins:[BlockModel],computed:{colors:function(){return _.merge({colors:{done:"#49c674"}},this.options,!0).colors},stylesheet:function(){return this.data?{done:{width:this.data.progress.value/this.data.progress.total*100+"%","background-color":this.colors.done}}:{}}},created:function(){var i=this;window.$events.on("courses:data",function(e,t){i.data=t.data,i.isFetching=!1}),this.block.tariff="business"},template:'<div class="block-course-progress has-rtl has-mb-1"> <div class="course-progress-title"> <div :class="{\'is-fetching-block\': isFetching}">Прогресс</div> <div v-if="data">{{data.progress.value}} из {{data.progress.total}}</div> </div> <div class="course-progress"><div :style="stylesheet.done" v-if="data"></div></div> </div>'}),window.$app.defineComponent("frontend","vue-frontend-blocks-form",{data:function(){return{isLoading:!1,isOpenModal:!1,defaults:{fields:[],form_text:this.$gettext("Спасибо за вашу заявку"),form_btn:this.$gettext("Отправить"),order_budget:0,order_purpose:"",payment_object_id:1,payment_object_value:null,is_order:0,form_type:"text",paid_status_id:3,paid_change_status:!0,target_id:null,target_value:null}}},props:{options:Object,block:Object,mode:{default:"view"}},mixins:[BlockModel],created:function(){var e,t;this.block.tariff="business","edit"==this.mode||(t=(e=document.location.search).match(/[\?|\&]form=([0-9]+)/))&&t[1]==this.block.block_id&&(e=e.replace(/[\?|\&]form=[0-9]+/,""),this.isOpenModal=!0,this.$router.replace(document.location.pathname+e))},methods:{submit:function(){var e,t=this;"edit"==this.mode||null!=(e=this.$refs.elements.getFields())&&(this.isLoading=!0,this.$api.post("form/push",{params:{fields:e,block_id:this.block.block_id}}).then(function(e){"success"==e.result?(window.$events.fire("lead",{lead_id:e.response.lead_id,addons:null!=t.values.data&&null!=t.values.data.link?t.values.data.link:null}),"https://www.messenger.com/closeWindow/"==e.response.redirect?window.location=e.response.redirect:"#"==e.response.redirect[0]?(t.values.form_text=e.response.redirect.substr(1),t.isOpenModal=!0):window.self!==window.top?window.open(e.response.redirect):window.location=e.response.redirect):null!=e.message&&alert(e.message),t.isLoading=!1,t.$nextTick(function(){t.$refs.form.reset()})}))}},template:'<form @submit.prevent="submit" ref="form"> <vue-frontend-form-complete-modal :isOpened.sync="isOpenModal" :message="values.form_text" v-if="mode != \'edit\'"/> <vue-frontend-form-elements :fields="values.fields" :options="values" :isLoading.sync="isLoading" ref="elements" :block_id="block.block_id" :mode="mode"/> </form>'}),window.$app.defineComponent("frontend","vue-frontend-blocks-html",{mounted:function(){this.refresh()},watch:{options:function(){this.refresh()}},props:["options","block"],created:function(){this.block&&(this.block.tariff="pro")},methods:{refresh:function(){var t=this;this.block&&!this.$auth.isAllowTariff(this.block.tariff)||this.$nextTick(function(){t.$el.innerHTML="";var e=Firewall.checkHTML(t.options.html);null==window.html_blocks_amount&&(window.html_blocks_amount=0),window.html_blocks_amount++,postscribe(t.$el,e,{done:function(){var e;window.html_blocks_amount--,window.html_blocks_amount||(window.dispatchEvent(new Event("load",{bubbles:!1})),document.dispatchEvent(new Event("DOMContentLoaded",{bubbles:!1})),(e=window.location.hash)&&(o=$mx(e),o.length?o.scrollIt(300):(o=$mx('[name="'+e.substr(1)+'"]'),o.length&&o.scrollIt(300))))},beforeWrite:Firewall.checkHTML})})}},template:"<div></div>"}),window.$app.defineComponent("frontend","vue-frontend-blocks-link",{data:function(){return{loading:"",signupShown:0,signupSending:!1,isOpenModal:!1,embededPageLoading:!1,embededHeight:null,embededTitleHeight:null,message:"",cookieToc:!1,addonIndex:-1,email:"",embededPageId:null,embededSection:null,fields:null,fields_options:{},keyIcon:0,defaults:{title:"",subtitle:"",type:"link",value:"",animation:"",thumb:{t:"n",i:null,p:null}}}},props:{options:Object,block:Object,section:Object,page_id:Number,isEmbeded:Boolean,theme:Object,mode:{default:"view"}},mixins:[BlockModel],created:function(){switch(this.values.type){case"emailsignup":case"product":case"collection":case"page":case"embeded":this.block.tariff="business"}},computed:{isAllowDesign:function(){return this.$auth.isAllowTariff("pro")},withoutThumb:function(){return null==this.values.thumb||"n"==this.values.thumb.t},classname:function(){var e=null!=this.values.animation&&this.values.animation&&!this.embededPageId?"has-animation has-animation-"+this.values.animation:"";return["button btn-link btn-link-styled",{"is-embeded-page":"embeded"==this.values.type,"is-close":this.$account.current_page_id==this.values.value,"is-already-embeded":this.isEmbeded,"is-opened":"embeded"==this.values.type&&this.embededPageId,"without-thumb":this.withoutThumb,"with-thumb":!this.withoutThumb,"is-loading":this.loading==this.block.stat||this.embededPageLoading},e]},stylesheets:function(){var e,t,i,s,n,a,o=this.theme,l=0,l=null!=this.section&&null!=this.section.link&&null!=this.section.link.transparent?this.section.link.transparent:o.link.transparent,r={};return this.embededPageId?(e=null!=(s=this.embededSection)&&null!=s.text?s.text.color:null!=this.section&&null!=this.section.link?this.section.link.color:o.screen.color,t=null!=s&&null!=s.text?s.text.color:null!=this.section&&null!=this.section.link?this.section.link.subtitle.color:o.screen.color,s&&(i=StylesFactory.getDefaultSection(o,!1),s=StylesFactory.restoreSection(s,o,i)),r={"--link-background":null!=s&&null!=s.bg&&null!=s.bg.color1?s.bg.color1:"transparent","--color-text":e,"--color-text-subtitle":t}):this.values.design&&this.values.design.on&&this.isAllowDesign&&(n=this.values.design.bg,r={"--link-background":transparentColor(100==l?0:l,n),"--color-text":this.values.design.text,"--color-text-subtitle":null!=this.values.design.subtitle?this.values.design.subtitle:this.values.design.text}),this.values.design&&this.values.design.on&&this.isAllowDesign&&(a=this.values.design.bg,r["--link-border-color"]=a),r},title:function(){return this.values.title?this.values.title:this.values.link},isExternal:function(){return"edit"==this.mode||-1!=["link","phone","email","sms"].indexOf(this.values.type)},isAnchor:function(){return"link"==this.values.type&&"#"==this.link.substr(0,1)},link:function(){return"view"==this.mode?this.$links.resolve(this.values):null}},methods:{innerButton:function(){var e="",t=this.thumb();return t&&(e+='<figure class="thumb">'+t+"</figure>"),e+='<div><div class="btn-link-title">'+this.$typography(this.title,!0)+"</div>",this.values.subtitle&&(e+='<div class="btn-link-subtitle">'+this.$typography(this.values.subtitle,!0)+"</div>"),e+="</div>"},thumb:function(){var e=this;if(null==this.values.thumb)return null;var t=this.values.thumb,i='<img src="data:image/gif;base64,R0lGODlhAQABAPAAAP///wAAACH5BAAAAAAALAAAAAABAAEAAAICRAEAOw==">';switch(t.t||"i"){case"i":if(t.i)return'<div class="is-icon">'+(this.$icons.get(t.i,function(){e.keyIcon++})||i)+"</div>";break;case"p":if(t.p)return'<div class="is-picture" style="background-image:url('+("//"+this.$account.storage_domain+"/p/"+t.p.filename)+')">'+i+"</div>"}return null},signupSend:function(){var t=this;this.signupSending=!0,this.$api.post("form/push",{params:{fields:[{type:6,value:this.email,idx:1}],block_id:this.block.block_id}}).then(function(e){"success"==e.result&&(window.$events.fire("lead",{lead_id:e.response.lead_id,addons:null!=t.values.data&&null!=t.values.data.link?t.values.data.link:null}),t.hideEmailSingnup(),"https://www.messenger.com/closeWindow/"==e.response.redirect?window.location=e.response.redirect:"#"==e.response.redirect[0]?(t.message=e.response.redirect.substr(1),t.isOpenModal=!0,t.email=""):window.top.location=e.response.redirect,"#"!=e.response.redirect[0]&&(t.loading=t.block.stat,t.stat(),setTimeout(function(){t.loading=""},2e3))),t.signupSending=!1})},hideEmailSingnup:function(){var e,t=this;this.signupShown=0,-1!=this.addonIndex&&(e=this.addonIndex,this.$account.widgets[e].data.isClosed=!0,setTimeout(function(){t.$account.widgets.splice(e,1)},250),this.addonIndex=-1),$mx("body").off("click",this.hideEmailSignup)},hideEmailSignup:function(e){$mx(this.$refs.form).has(e.target).length||$mx(".footer-banner").has(e.target).length||$mx(".modal").has(e.target).length||this.hideEmailSingnup()},hideEmbeded:function(){var e=this;this.embededHeight=null,$mx(window).off("resize",this.checkEmbededHeight),this.embededPageId!=this.values.value&&(this.fields=null),setTimeout(function(){e.embededPageId=null,$events.fire("contentupdated")},250)},checkEmbededHeight:function(){this.$refs.embeded&&(this.embededHeight=$mx(this.$refs.embeded.$el).outerHeight())},fetchEmbededPage:function(t){var i=this;if(this.$account.current_page_id==t)return this.hideEmbeded();this.embededPageLoading=!0,this.$api.get("page/get",{params:{part:this.part,page_id:t}}).then(function(e){null!=e.redirect?i.$router.replace(e.redirect):(i.fields=e.response.fields,i.embededSection=i.fields&&_.size(i.fields)&&i.fields[0].section?i.fields[0].section:null,i.fields=_.filter(_.map(i.fields,function(e){return e.items=_.filter(_.map(e.items,function(e){return"avatar"==e.block_type_name?null:e})),e.items.length?e:null})),i.fields_options=e.response.options,$events.fire("pageview",{page_id:t,profile_id:i.$account.profile_id}),$events.fire("contentupdated"),i.checkHeight(),$mx(window).on("resize",i.checkEmbededHeight),i.embededPageId=t,i.$account.embeded=i),i.embededPageLoading=!1})},checkHeight:function(){var t=this;_.each([150,500,700],function(e){return setTimeout(t.checkEmbededHeight,e)})},stat:function(e){var t=0<arguments.length&&void 0!==e?e:null;window.$events.fire("tap",{page_id:this.page_id,block_id:this.block.block_id,stat:this.block.block_id+"."+this.block.stat,data:[t],addons:null!=this.values.data&&null!=this.values.data.link?this.values.data.link:null})},click:function(e){var t,i=this;if("edit"!=this.mode)if("embeded"==this.values.type)if(this.embededPageId)this.hideEmbeded();else{if(this.isEmbeded)return this.$account.embeded.fetchEmbededPage(this.values.value);this.embededTitleHeight=$mx(this.$el).outerHeight(),this.fields?(this.embededPageId=this.values.value,setTimeout(this.checkEmbededHeight,150),$mx(window).on("resize",this.checkEmbededHeight)):this.fetchEmbededPage(this.values.value)}else"emailsignup"==this.values.type?(this.signupSending=!0,this.signupShown=1,this.signupSending=!1,setTimeout(function(){i.signupShown=2,setTimeout(function(){i.$refs.input.focus(),$mx("body").on("click",i.hideEmailSignup),i.values.value.agreement&&(i.$account.widgets.push({name:"agreement-banner",data:{message:i.values.value.agreement,isClosed:!0}}),i.addonIndex=i.$account.widgets.length-1,setTimeout(function(){i.$account.widgets[i.addonIndex].data.isClosed=!1},150))},100)},250)):(t=_.isObject(this.link)?this.$router.resolve(this.link).href:this.link,this.isAnchor?($mx('[name="'+t.substr(1)+'"]').scrollIt(500),e.preventDefault()):(this.loading=this.block.stat,this.stat({event:"taplink:"+this.values.type,param:t}),this.isExternal||e.preventDefault(),setTimeout(function(){i.loading=""},2e3)))}},template:'<div v-if="values.type == \'emailsignup\'" :style="stylesheets"> <vue-frontend-form-complete-modal :isOpened.sync="isOpenModal" :message="message"/> <transition name="fade" mode="out-in" :duration="100"> <form ref="form" v-if="signupShown" @submit.prevent="signupSend" class="email-signup" :class="classname"><input type="email" v-model="email" class="input" required ref="input" :disabled="signupSending" placeholder="example@domain.com"><button class="button" :class="{\'is-loading\': signupSending, in: signupShown== 2}" type="submit">{{\'Отправить\'|gettext}}</button></form> <component v-bind:is="(mode == \'view\')?\'a\':\'div\'" v-else :class="classname" @click="click" v-html="innerButton()" :key="keyIcon"></component> </transition> </div> <div v-else-if="values.type == \'embeded\'" :style="stylesheets"> <component v-bind:is="(mode == \'view\')?\'a\':\'div\'" :class="classname" @click="click" v-html="innerButton()" :key="keyIcon"/> <div class="is-embeded-content" v-if="embededPageId"> <div :style="{height: this.embededHeight?(this.embededHeight+\'px !important\'):null}"><vue-frontend-page-blocks :fields="fields" :page_id="values.value" part="p" :is-embeded="true" v-if="fields" ref="embeded" @checkHeight="checkHeight"/></div> </div> </div> <component v-bind:is="(mode == \'view\')?\'a\':\'div\'" v-else-if="isExternal" rel="noopener" :href=\'link\' :class="classname" @click="click" :style="stylesheets" v-html="innerButton()" :key="keyIcon" :target="(options.open_new_window || $account.open_new_window)?\'_blank\':\'_top\'"/> <router-link v-else rel="noopener" :to=\'link\' :class="classname" @click.native="click" :style="stylesheets" v-html="innerButton()" :key="keyIcon"/>'}),window.$app.defineComponent("frontend","vue-frontend-blocks-map",{data:function(){return{map:null,icon:null,loading:null,markers:[],defaults:{bounds:[],markers:[],show_buttons:!0,is_fixed:!0,show_types:!1,show_zoom:!1,show_street:!1}}},props:{options:Object,block:Object,page_id:Number,mode:{default:"view"}},mixins:[BlockModel],mounted:function(){this.rebuild()},created:function(){this.block.tariff="pro"},watch:{values:function(){this.refresh()}},computed:{styleSheets:function(){return this.values.design&&this.values.design.on?"background:"+this.values.design.bg+";border-color:"+this.values.design.bg+";color:"+this.values.design.text:""},isSupportWebp:function(){var e=document.createElement("canvas");return!(!e.getContext||!e.getContext("2d"))&&0==e.toDataURL("image/webp").indexOf("data:image/webp")}},methods:{click:function(e,t){var i=this;this.loading=t,window.$events.fire("tap",{page_id:this.page_id,block_id:this.block.block_id,slot:t,stat:this.block.block_id+"."+this.block.stat[t],data:[{event:"taplink:map",param:e.lat+":"+e.lng}]}),window.top.location=this.link(e),setTimeout(function(){i.loading=null},2e3)},rebuild:function(){var i=this;$mx.lazy("map.js","map.css",function(){var e=i.values.bounds,t=i.values.is_fixed;i.map=L.map(i.$refs.map,{dragging:!t,doubleClickZoom:!t,boxZoom:!t,touchZoom:!t,scrollWheelZoom:!t,zoomControl:!0,attributionControl:!1}).setView([e.center.lat,e.center.lng],i.values.zoom),e.bounds&&i.map.fitBounds(e.bounds),L.control.attribution({prefix:""}).addTo(i.map),L.tileLayer("https://m.taplink.cc/{z}/{x}/{y}."+(i.isSupportWebp?"webp":"png"),{attribution:"view"==i.mode?'<a href="https://taplink.cc" target="_blank">Taplink</a> <span style="color:#ccc">|</span> <a href="https://www.openstreetmap.org/copyright" target="_blank">OpenStreetMap</a>':"",crossOrigin:!0}).addTo(i.map),i.icon=L.icon({iconUrl:"/s/i/marker.png",iconSize:[28,37],popupAnchor:[0,-10],shadowUrl:"/s/i/marker-shadow.png",shadowSize:[40,50],shadowAnchor:[12,31]}),i.fillMarkers()})},refresh:function(){var e;this.map&&(e=this.values.bounds,this.map.fitBounds(e.bounds),this.fillMarkers(),this.map.options.zoomControl=!0)},fillMarkers:function(){for(var i=this,e=0;e<this.markers.length;e++)this.map.removeLayer(this.markers[e]);_.each(this.values.markers,function(e){var t=L.marker([parseFloat(e.lat),parseFloat(e.lng)],{icon:i.icon}).addTo(i.map);t.bindPopup("<b>"+e.title+"</b>"+(e.text?"<div>"+e.text.toString().replace(/\n/g,"<br>")+"</div>":"")),i.markers.push(t)})},link:function(e){return"https://maps.google.com/?q="+e.lat+","+e.lng+"&z="+this.values.bounds.zoom}},template:'<div> <div class="map-container btn-link-block"> <div class="map-view" ref="map" :class="{\'map-view-with-zoom-control\': values.show_zoom}"></div> </div> <component v-bind:is="(mode == \'view\')?\'a\':\'div\'" v-if="values.show_buttons" v-for="(m, i) in values.markers" :href=\'link(m)\' @click.prevent="click(m,i)" target="_top" class="button btn-link btn-link-block btn-map btn-link-styled btn-link-title" :class="{\'is-loading\': loading== i}" :style="styleSheets"> <i class="fa fai fa-map-marker-alt"></i><span>{{m.title|nvl($gettext(\'Заголовок\'))}}</span> </component> </div>'}),window.$app.defineComponent("frontend","vue-frontend-blocks-media",{data:function(){return{lazyHit:!1,values:{},keyComponent:0,defaults:{fields:[],styles:{shape:"square",style:"none",size:48,text_size:"md",color:"",align:"l",cols:1,spacing:1,centered:1}}}},props:{options:Object,section:Object,mode:{default:"view"}},mixins:[BlockModel],computed:{style:function(){var e=this.values.styles.text_size;return{"line-height":FontsFactory.getLineHeight(e),"font-size":FontsFactory.getTextSize(e)}},styleList:function(){var e={"--card-spacing":15*this.values.styles.spacing+"px","--icon-size":this.values.styles.size+"px","--icon-border":"2px"};return this.values.styles.color&&(e["--icon-color"]=this.values.styles.color),e},isIcons:function(){return 0==_.sum(_.map(this.values.fields,function(e){return(e.title||"").length+(e.text||"").length}))},hasCentered:function(){return"c"==this.values.styles.align&&this.values.styles.centered}},methods:{lazy:function(){this.lazyHit=!0},parse:function(e,t){var i="view"==this.mode?"a":"contact";return this.$parseContacts(this.$typography(e,t),i)},icon:function(e){var t=this;return this.lazyHit?this.$icons.get(e.thumb.i,function(){t.keyComponent++}):null}},template:"<div style=\"overflow: hidden\"> <ul :style=\"styleList\" :key=\"keyComponent\" :class=\"['is-align-'+values.styles.align, isIcons?'is-icons':'row']\"> <li v-for=\"f in values.fields\" class=\"media\" :class=\"isIcons?'':('col-xs-12 col-sm-'+(12/values.styles.cols))\" :style=\"values.styles.color?{'--text-color-contrast': (lightOrDark(values.styles.color) == 'light')?'#000':'#fff'}:null\"> <div v-if=\"f.thumb && f.thumb.t != 'n'\" :class=\"'is-'+values.styles.shape+' is-'+values.styles.style\"> <span :data-src=\"(f.thumb.t == 'p')?('//'+$account.storage_domain+'/p/'+f.thumb.p.filename):null\" :class=\"{'is-icon': f.thumb.t == 'i', 'is-image lazy': f.thumb.t == 'p', 'lazy-force': mode== 'edit'}\"> <figure v-if=\"f.thumb.t == 'i'\" v-html=\"icon(f)\" class=\"lazy\" :class=\"{'lazy-force': mode== 'edit'}\" @lazy-hit=\"lazy\"></figure> <figure v-if=\"f.thumb.t == 'p'\"></figure> </span> </div> <div :style=\"style\"> <div v-if=\"f.title\" class=\"has-rtl is-heading has-text-weight-semibold\" :class=\"{'has-text-centered': hasCentered}\" v-html=\"parse(f.title, true)\"/> <div v-if=\"f.text\" class=\"has-rtl\" :class=\"{'has-text-centered': hasCentered}\" v-html=\"parse(f.text, false)\"/> </div> </li> </ul> </div>"}),window.$app.defineComponent("frontend","vue-frontend-blocks-messenger",{data:function(){return{loading:null,values:null,v:null,defaults:{items:[],messenger_style:{layout:"full",shape:"brand",design:"brand",colors:{bg:null,text:null,icon:null}}}}},props:{options:Object,block:Object,page_id:Number,section:Object,theme:Object,mode:{default:"view"}},mixins:[BlockModel],created:function(){this.initData(),this.block.tariff="plus"},watch:{values:function(){this.initData()}},methods:{initData:function(){this.v=this.values.messenger_style},iconPaths:function(e){var t="";if(null!=e.ip)for(i=1;i<=e.ip;i++)t+='<span class="p'+i+'"></span>';return t},click:function(e,t){var i=this;this.loading=t.n;var s=this.block.stat[t.n].split("."),n=[{event:"taplink:messengers",param:s[s.length-1]+":"+t.v},{event:"taplink:messengers:"+s[s.length-1],param:t.v}];if($events.fire("tap",{page_id:this.page_id,block_id:this.block.block_id,slot:this.block.slot[t.n],stat:this.block.block_id+"."+this.block.stat[t.n],data:n,addons:null!=this.values.data&&null!=this.values.data[t.n]?this.values.data[t.n]:null}),$events.fire("messenger",t),setTimeout(function(){i.loading=""},2e3),e.target.href==t.link.b||this.$device.isOpera)return!0;e.preventDefault(),this.$links.deeplink(t.link)},link:function(e){return"view"==this.mode?this.$links.application(e.link):null},classname:function(e){return["button btn-link is-service-"+e.i,"is-layout-"+this.v.layout,this.isFlat?null:"btn-socials","is-shape-"+this.v.shape,"is-design-"+this.v.design,"full"==this.v.layout?"btn-link-styled":null]}},computed:{isFlat:function(){return"full"==this.v.layout&&"flat"==this.v.shape},stylesheet:function(){var e=this.theme,t=0;if(100==(t=null!=this.section&&null!=this.section.link&&null!=this.section.link.transparent?this.section.link.transparent:e.link.transparent)&&(t=0),"custom"!=this.v.design)return null;switch(this.v.shape){case"icon":return{"--icon-text":this.v.colors.icon};default:return{"--link-background":transparentColor(t,this.v.colors.bg),"--link-background-digs":hexToRgb(this.v.colors.bg),"--link-border-color":this.v.colors.bg,"--color-text":this.v.colors.text}}}},template:'<div class="socials" v-if="v"> <div class="row row-small"> <div :class="{\'col-shrink\': v.layout == \'square\', \'col-xs\': v.layout != \'full\', \'col-xs-12\': v.layout == \'full\'}" v-for="l in values.items"> <component v-bind:is="(mode == \'view\')?\'a\':\'div\'" :href=\'link(l)\' @click="click($event, l)" target="_top" :aria-label="l.t" :class="classname(l)" :style="stylesheet"> <i :class="\'fa fab fa-\'+l.i" v-if="!isFlat" v-html="iconPaths(l)"></i> <div v-if="v.layout == \'full\'" v-html="$typography(l.t, true)"></div> </component> </div> </div> </div>'}),window.$app.defineComponent("frontend","vue-frontend-blocks-music",{data:function(){return{sample:null,size:null,titles:{sc:"Sound Cloud",pm:"Apple Music",ym:"Яндекс.Музыка",sp:"Spotify",dz:"Deezer",bc:"Bandcamp",sb:"Сбер Звук",mk:"Audiomack",an:"Anghami",am:"Amazon Music",vk:"ВКонтакте",yt:"Youtube Music",bs:"BeatStars",pd:"Pandora",bm:"Boom",td:"Tidal"},defaults:{items:[],sample:"",size:"m"}}},props:["options","block"],mixins:[BlockModel],created:function(){this.initData(),this.block.tariff="pro"},watch:{values:function(){this.initData()}},methods:{initData:function(){if(this.sample="",!this.values.sample)return null;var e,t={sc:[{s:"https://w.soundcloud.com/player/?url={1}&color=d81946&theme_color=d81946&auto_play=false&hide_related=true&show_comments=false&show_user=false&show_reposts=false&show_teaser=true&like=false&sharing=false&download=false&buying=false&text_buy_track=false&visual=true"}],ym:[{r:/\/album\/([0-9]+)\/track\/([0-9]+)/g,s:"https://music.yandex.ru/iframe/#track/{3}/{2}/"},{r:/\/users\/([^\/]+)\/playlists\/([0-9]+)/g,s:"https://music.yandex.ru/iframe/#playlist/{2}/{3}"},{r:/\/([0-9]+)/g,s:"https://music.yandex.ru/iframe/#album/{2}/"}],pm:[{r:/music\.apple\.com\/(.*)/g,s:"https://embed.music.apple.com/{2}"}],sp:[{r:/\/(track|album|playlist)\/(.*)/g,s:"https://open.spotify.com/embed/{2}/{3}"}],dz:[{r:/\/(track|album|playlist)\/(.*)/g,s:"https://widget.deezer.com/widget/auto/{2}/{3}"}],sb:[{r:/\/(track|release|playlist|podcast)\/([0-9]+)/g,s:"https://sber-zvuk.com/embed/{2}?id={3}"}],mk:[{r:/audiomack\.com\/([^\/]+)\/(album|song|playlist)\/([^\/]+)/g,s:"https://audiomack.com/embed/{3}/{2}/{4}?background=1"}],an:[{r:/play\.anghami\.com\/(album|song|playlist)\/([^\/]+)/g,s:"https://widget.anghami.com/{2}/{3}/?layout=wide"}]},i=_.filter(this.values.items,{n:this.values.sample})[0],s=[t[this.values.sample],i.url],a=null,o=null!=s[0];for(j in t[this.values.sample]){if(e=null!=(a=t[this.values.sample][j]).r?a.r.exec(s[1]):null){for(s[0]=a.s,n=1;n<e.length;n++)s.push(e[n]);break}null==a.r&&(s[0]=a.s)}var l;o?("p"==(l=i.t)&&(l="a"),this.sample=this.$format.apply(null,s),this.size={sc:{t:{s:300,m:450,l:600},a:{s:300,m:450,l:600}},ym:{t:{s:70,m:120,l:240},a:{s:240,m:450,l:600}},pm:{t:150,a:450},sp:{t:80,a:380},dz:{t:{s:70,m:120,l:240},a:{s:240,m:450,l:600}},sb:{t:240,a:450,c:450},mk:{t:252,a:400}}[this.values.sample][l],_.isObject(this.size)&&(this.size=this.size[this.values.size])):this.sample=this.size=null},empty:function(e){return e.b?e.b:this.$gettext("Слушать")}},template:'<div> <iframe width="100%" :height="size" scrolling="no" frameborder="no" :src="sample" v-if="sample" sandbox="allow-forms allow-popups allow-same-origin allow-scripts allow-top-navigation-by-user-activation" allow="autoplay *; encrypted-media *; fullscreen *"></iframe> <a v-for="f in values.items" class="music-source" v-if="!sample || (sample && values.items.length> 1)" target="_blank" :href="f.url"> <div><span :class="\'btn-socials is-shape-circle-fill is-design-brand is-service-\'+f.n"><i :class="\'fa fab fa-\'+f.n"></i></span><span class="t">{{titles[f.n]}}</span></div> <span class="button" v-html="empty(f)"></span> </a> </div>'}),window.$app.defineComponent("frontend","vue-frontend-blocks-pictures",{data:function(){return{hack:!1,loading:"",index:0,defaults:{list:[],picture_size:100,carousel_ride:!1,carousel_interval:5,is_desktop_fullwidth:!1,options:{text:0,link:0}}}},props:{options:Object,block:Object,page_id:Number,theme:Object,mode:{default:"view"}},mixins:[BlockModel],created:function(){this.block.tariff="pro"},computed:{dataInterval:function(){return"view"==this.mode&&this.values.carousel_ride&&this.$auth.isAllowTariff("pro")?this.values.carousel_interval:null},colorClass:function(){var e=this.theme,t=this.values.design.on?this.values.design.bg:(null==e.block?StylesFactory.getBaseStyles():e).block.pictures.bg;return isLightColor(t)?"is-light":"is-dark"}},watch:{block:function(){var e=this;this.hack=!0,this.$nextTick(function(){e.hack=!1})}},methods:{isLoading:function(e){return"view"==this.mode&&null!=this.block.stat&&this.loading==this.block.stat[e]},stylesheetPicture:function(e,t){var i=this.urlPicture(e,!1),s={"padding-top":{100:100,70:"70.6",50:50,138:"141.4516"}[t.picture_size]+"%"};return"edit"==this.mode&&i&&(s["background-image"]="url("+i+")"),s},urlPicture:function(e,t){return(!t||"edit"!=this.mode)&&(e.picture||e.p)?"//"+this.$account.storage_domain+"/p/"+(null==e.picture?e.p.filename:e.picture):null},isExternal:function(e){return-1!=["link","phone","email",""].indexOf(e.type)},link:function(e){return"view"==this.mode?this.$links.resolve(e):null},click:function(e,t){var i=this;this.loading=this.block.stat[t];var s=this.$links.resolve(e.link),s=_.isObject(s)?this.$router.resolve(s).href:s;window.$events.fire("tap",{page_id:this.page_id,block_id:this.block.block_id,slot:t,stat:this.block.block_id+"."+this.block.stat[t],data:[{event:"taplink:pictures",param:s}]}),this.isExternal(e.link)&&(document.location=this.link(e.link)),setTimeout(function(){i.loading=""},2e3)}},template:'<div class="block-slider" :class="[{\'is-allow-fullwidth\': values.is_desktop_fullwidth}, colorClass]"> <div class="block-slider-inner"> <div ref=\'device\' v-if="!hack" class="slider slider-pictures has-mb-2" :data-interval="dataInterval" :class="{\'slider-has-text\': values.options.text, \'slider-has-link\': values.options.link, \'slider-has-border\': !values.remove_border}"> <div class="slider-inner"> <div class="slider-slide" :class="{active: index== i}" v-for="(f, i) in values.list"> <div class="picture-container" :class="{\'picture-container-empty\': !f.p}" :style="stylesheetPicture(f, values)" :data-picture="urlPicture(f, true)"></div> <div class="slider-slide-text has-rtl"> <div class="slider-slide-title" v-if="f.t" v-html="$typography(f.t, true)"></div> <div class="slider-slide-title" v-else>{{\'Заголовок\'|gettext}}</div> <div class="slider-slide-snippet" v-html="$typography(f.s, true)"></div> </div> <component v-bind:is="(mode == \'view\')?\'a\':\'block\'" v-if="isExternal(f.link) || (mode == \'edit\')" class="slider-slide-link" :class="{\'is-loading\': isLoading(i)}" rel="noopener" target="_top" :href=\'link(f.link)\' @click.prevent="click(f, i)">{{f.link.title|nvl($gettext(\'Открыть\'))}}</component> <router-link v-else class="slider-slide-link" :class="{\'is-loading\': isLoading(i)}" rel="noopener" :to=\'link(f.link)\' @click.native="click(f, i)">{{f.link.title|nvl($gettext(\'Открыть\'))}}</router-link> </div> </div> <div class="slider-nav" :class="{\'is-hidden\': values.list.length == 1}" ref=\'sliders\'> <div v-for="(v, i) in values.list" class="slider-dot" :class="{active: index== i}" @click="index = i"></div> </div> </div> </div> </div>'}),window.$app.defineComponent("frontend","vue-frontend-blocks-pricing",{data:function(){return{defaults:{fields:[],styles:{text_size:"md"}}}},props:["options","block"],mixins:[BlockModel],created:function(){this.block.tariff="pro"},computed:{styleText:function(){var e=this.values.styles.text_size;return{"font-size":FontsFactory.getTextSize(e),"line-height":FontsFactory.getLineHeight(e)}}},template:'<ul :style="styleText"> <li v-for="f in values.fields"> <span v-if="f.title" v-html="$nl2br(f.title)"></span><span v-else>{{\'Без имени\'|gettext}}</span> <span></span> <span>{{$nvl(f.price, 0)|currency}}</span> </li> </ul>'}),window.$app.defineComponent("frontend","vue-frontend-blocks-products-breadcrumbs",{data:function(){return{step:0,defaults:{colors:{bg:{active:null,inactive:null},text:{active:null,inactive:null}}}}},props:["options","page_id","block"],mixins:[BlockModel],created:function(){this.block.tariff="business",window.$events.on("products:stepchanged",this.stepChanged)},beforeDestroy:function(){window.$events.off("products:stepchanged",this.stepChanged)},computed:{o:function(){return _.merge(this.defaults,this.options,!0)},styleColors:function(){var e=this.o.colors;return{"--breadcrumbs-active-bg":e.bg.active,"--breadcrumbs-inactive-bg":e.bg.inactive,"--breadcrumbs-active-color":e.text.active?e.text.active:e.bg.active?isLightColor(e.bg.active)?"#000":"#fff":null,"--breadcrumbs-inactive-color":e.text.inactive?e.text.inactive:e.bg.inactive?isLightColor(e.bg.inactive)?"#000":"#fff":null}}},methods:{setStep:function(e){this.step=e,window.$events.fire("products:stepchanged",{step:e})},stepChanged:function(e,t){this.step=t.step}},template:'<div class="field has-addons basket-breadcrumbs" data-toggle="buttons" :style="styleColors"> <div class="control is-expanded" style="width: 33.3%"><label class="button is-fullwidth" :class="{active: step>= 0}" @click="setStep(0)"><i>{{\'Корзина\'|gettext}}</i></label></div> <div class="control is-expanded" style="width: 33.3%"><label class="button is-fullwidth" :class="{active: step>= 1, \'is-disabled\': step < 1}" @click="setStep(1)"><i>{{\'Контакты\'|gettext}}</i></label></div> <div class="control is-expanded" style="width: 33.3%"><label class="button is-fullwidth" :class="{active: step>= 2, \'is-disabled\': step < 2}"><i>{{\'Подтверждение\'|gettext}}</i></label></div> </div>'}),window.$app.defineComponent("frontend","vue-frontend-blocks-products-checkout",{data:function(){return{step:0,cart:null,fields:null,fields_footer:null,shipping:null,discounts:null,amount_issues:{},hasPromocodes:!1,confirm:null,button:null,isFetching:!1,contacts:{},errors:{},failed:null,isOpenPromocodeForm:!1,isCheckingPromocode:!1,promocode:"",errorPromocode:"",defaults:{amount:{colors:{bg:null,button:{bg:null,text:null}}}}}},props:["options","page_id","block","data"],mixins:[BlockModel],mounted:function(){window.$events.on("products:stepchanged",this.stepChanged),this.initData(this.data?this.data:{amount_issues:{2:2},cart:{1:{amount:1,title:"Товар 1",subtitles:["Размер: XL"],price:100,product_id:1,is_active:1},2:{amount:3,title:"Товар 2",subtitles:["Цвет: черный"],price:100,product_id:2,is_active:1}},discounts:[],has_promocodes:0})},beforeDestroy:function(){window.$events.off("products:stepchanged",this.stepChanged)},computed:{o:function(){return _.merge(this.defaults,this.options,!0)},styleColors:function(){var e=this.o.amount.colors;return{"--product-checkout-amount-bg":e.bg,"--product-checkout-amount-button-bg":e.button.bg,"--product-checkout-amount-button-text":e.button.text?e.button.text:e.button.bg?isLightColor(e.button.bg)?"#000":"#fff":null}},discountValue:function(){var n=this,a=0,o=[],l=!1;return _.each(this.discounts,function(i){var e;if(!l)switch(i.profit){case"free_shipping":break;default:switch(i.profit_apply){case"order":var t=Math.pow(10,n.$account.currency.precision);"percentage"==i.profit?(a+=_.sumBy(n.cart,function(e,t){return-1==o.indexOf(e.id)?(o.push(e.id),e.amount*(i.apply_options?e.price:e.price_offer)/100*i.profit_value):0}),e=a,a=Math.round(e*t)/t):i.profit_value&&(a=i.profit_value,l=!0);break;case"offers":var s=i.profit_offers;a+=_.sumBy(n.cart,function(e,t){return null!=s[e.id]&&-1==o.indexOf(e.id)?(o.push(e.id),e.amount*Math.max(0,(i.apply_options?e.price:e.price_offer)-s[e.id])):0})}}}),a},shippingPrice:function(){for(i in this.discounts){if("free_shipping"==this.discounts[i].profit)return 0}return this.confirm.shipping.price},total_compare:function(){return _.sumBy(this.cart,function(e){return(e.price_compare&&0<e.price_compare&&e.price_compare>e.price?e.price_compare:e.price)*e.amount})},total:function(){return _.sumBy(this.cart,function(e){return e.price*e.amount})},title_zones:function(){return null!=this.shipping.title_zones&&this.shipping.title_zones?this.shipping.title_zones:this.$gettext("Другие страны")},isSelfservice:function(){return""!=this.fields.shipping_method.value&&0==this.fields.shipping_method.value.indexOf("selfservice:")},userShipping:function(){return 1<this.shipping.amount_methods||1==this.shipping.amount_methods&&!this.shipping.use_zones},isAllowAction:function(){switch(this.step){case 0:return this.cart&&this.cart.length&&_.sum(this.cart,"is_active")==this.cart.length&&0==_.size(this.amount_issues);case 1:return 0==Object.keys(this.errors).length&&null==this.failed;case 2:return!0}}},methods:{amountError:function(e){return null==this.amount_issues[e.id]&&e.is_active?null:e.is_active?null!=this.amount_issues[e.id]?this.amount_issues[e.id]?this.$gettext("В наличии")+" "+this.amount_issues[e.id]+" "+this.$gettext("шт."):this.$gettext("Нет в наличии"):void 0:this.$gettext("Не доступно для продажи")},hasError:function(e){return!e.is_active||null!=this.amount_issues[e.id]},setStep:function(e){this.step!=e&&(this.errors=[],this.failed=null,this.step=e,window.$events.fire("products:stepchanged",{step:this.step}),1==e&&$events.fire("initiateCheckout",{value:this.total-this.discountValue}))},stepChanged:function(e,t){this.setStep(t.step)},promocodeFilter:function(e){var t=e.which?e.which:e.keyCode;if(13==t)return!0;String.fromCharCode(t).toUpperCase().match(/[A-ZА-Яa-zа-я0-9\-_]/)||e.preventDefault()},promocodeFilterAfter:function(){this.promocode=this.promocode.toUpperCase().replace(/[^A-ZА-Я0-9\-_ ]/g,"").trim().replace(/ /g,"_")},openPromocodeForm:function(){var e=this;this.isOpenPromocodeForm=!0,setTimeout(function(){e.$refs.inputPromocode.focus()},600)},closePromocodeForm:function(){this.promocode=this.errorPromocode="",this.isOpenPromocodeForm=!1},applyPromocode:function(){var t=this;this.isCheckingPromocode=!0,this.$api.get("market/checkout/promocode",{params:{promocode:this.promocode}},this).then(function(e){"success"==e.result?(t.discounts=e.response.discounts,t.closePromocodeForm()):(t.errorPromocode=e.fail,t.$nextTick(function(){t.$refs.inputPromocode.focus()})),t.isCheckingPromocode=!1}).catch(function(){t.isCheckingPromocode=!1})},clearPromocode:function(){var t=this;this.$api.get("market/checkout/clearpromocode").then(function(e){"success"==e.result&&(t.discounts=e.response.discounts)})},checkFieldDepends:function(e){return null!=this.fields[e.depends_name]&&-1!=e.depends_value.indexOf(this.fields[e.depends_name].value)},fetchData:function(){var t=this;this.isFetching=!0,this.$api.get("market/checkout/basket",{}).then(function(e){"success"==e.result&&t.initData(e.response),t.isFetching=!1})},amountFilter:function(e){var t=e.which?e.which:e.keyCode;(t<48||57<t)&&e.preventDefault()},amountFilterCheck:function(e){e.amount=""===e.amount?0:parseInt(e.amount)},amountBlur:function(e,t){e.amount||this.cart.splice(t,1),this.updateCart()},amountChange:function(e,t,i){e.amount+=i,this.amountBlur(e,t)},updateCart:function(){var t=this;this.$actionbar.info.basket.products={},_.each(this.cart,function(e){t.$actionbar.info.basket.products[e.id]=e.amount}),this.$actionbar.pack(),this.updateDiscount()},updateDiscount:_.debounce(function(){var t=this;this.$api.get("market/checkout/check",{}).then(function(e){"success"==e.result&&Object.assign(t,e.response)})},500),initData:function(e){var i=this;this.cart=_.map(e.cart,function(e,t){return e.id=t,e.link={name:"part",params:{page_id:e.product_id.toString(16),part:"o"}},e.style=e.picture?"background-image:url(//"+i.$account.storage_domain+"/p/"+e.picture+")":"",e.subtitles=null!=e.subtitles?e.subtitles.join(", "):"",e}),this.discounts=e.discounts,this.amount_issues=e.amount_issues,this.hasPromocodes=e.has_promocodes,window.$events.fire("setpage",this)},getFields:function(){var e=[this.$refs.fields1,this.$refs.fields2,this.$refs.fields3],t={};if(this.shipping.is_active){if(!this.userShipping&&this.shipping.use_zones&&(this.fields.shipping_method.value="zones"),this.userShipping&&!this.fields.shipping_method.value)return void alert(this.$gettext("Необходимо выбрать метод доставки"));null!=this.fields.shipping_method&&(t.shipping_method={value:this.fields.shipping_method.value})}for(var i=0;i<=2;i++)if(null!=e[i]){var s=e[i].getFields();if(!s){t=null;break}t=Object.assign(t,s)}return t},submitCheckout:function(){var t=this;this.contacts=this.getFields(),this.contacts&&(this.isFetching=!0,this.errors=[],this.failed=null,this.$api.post("market/checkout/confirm",{params:{fields:this.contacts}}).then(function(e){"success"==e.result?(t.confirm=e.response,t.button=e.response.button,t.setStep(t.step+1)):t.checkResult(e),t.isFetching=!1}))},action:function(){var i=this;switch(this.step){case 0:this.isFetching=!0,this.errors=[],this.failed=null,this.$api.get("market/checkout/checkout",{}).then(function(e){var t;"success"==e.result?(t=e.response,i.fields=t.fields,i.fields_footer=t.fields_footer,i.shipping=t.shipping):i.checkResult(e),i.isFetching=!1,i.setStep(i.step+1)});break;case 1:this.$refs.submit.click();break;case 2:this.isFetching=!0,this.$api.post("market/checkout/pay",{params:{fields:this.contacts}}).then(function(e){"success"==e.result?(window.$events.fire("lead",{lead_id:e.response.lead_id}),null!=e.response.redirect?window.top.location=e.response.redirect:i.checkResult(e)):i.checkResult(e)})}},checkResult:function(e){this.errors=e.errors||[],this.failed=e.failed||null,this.isFetching=!1,"recheck"==e.result&&(this.setStep(0),this.fetchData()),"empty"==e.result&&(this.$actionbar.init(),this.$router.replace({name:"catalog"}))}},template:'<div> <div class="message is-danger" style="font-size: 1.9em !important;" v-if="failed"> <div class="message-body">{{failed}}</div> </div> <div class="block-item" v-if="step == 0"> <div class="has-pt-2 has-pb-2" v-if="isFetching"> <div class="loading-overlay loading-block is-active"><div class="loading-icon"></div></div> </div> <div v-else> <div class="has-p-2 block-text" v-if="!cart || cart.length == 0"> <div class="border-vertical has-text-centered">{{\'Корзина пуста\'|gettext}}</div> </div> <div class="block-text has-rtl products-cart" :style="styleColors" v-else> <div class="row row-small" v-for="(f, k) in cart"> <div class="col-sm-1 col-xs-3"><div class="has-text-centered" style="width:100%"><router-link :to="f.link" class="product-container-outer slider-has-border"><div class=\'product-container\' :class="{\'product-container-empty\': !f.picture}" :style="f.style"></div></router-link></div></div> <div class="col-sm-11 col-xs-9"> <div class="row row-small"> <div class="col-sm col-xs-12 has-xs-mb-1"><router-link :to="f.link" style="line-height: 1;display: inline-block">{{f.title}}</router-link><div v-if="f.subtitles" style="font-size: 70%;opacity: .5">{{f.subtitles}}</div></div> <div class="col-sm col-sm-shrink col-xs-5"> <div class="field"> <span class="control" style="display: block"> <div class="field field-amount" :class="{\'has-addons\': hasError(f) || !isTransparentColor(o.amount.colors.bg), error: hasError(f)}" :data-error="amountError(f)"> <span class="control"><button class="button" @click="amountChange(f, k, -1)"><i class="fai fa-minus"></i></button></span> <span class="control"><input type=\'number\' class="input skip-enter" v-model="f.amount" min="0" max="999999" @keypress="amountFilter" @keyup="amountFilterCheck(f)" @blur="amountBlur(f, k)"></span> <span class="control"><button class="button" @click="amountChange(f, k, 1)"><i class="fai fa-plus"></i></button></span> </div> </span> </div> </div> <div class="col-sm-2 col-md-3 col-lg-2 col-xs-7 has-text-nowrap has-text-right"><div class="has-text-right" style="width:100%"> <div v-if="f.price_compare && f.price_compare> f.price" style="font-size: 70%;opacity: .2;height: 0 !important;position: relative;"><span class="strikethrough" style="position: absolute;right: 0;top: -15px;">{{f.price_compare*f.amount|currency}}</span></div> {{f.price*f.amount|currency}} </div></div> </div> </div> </div> <vue-frontend-market-discount @openPromocodeForm="openPromocodeForm" @clearPromocode="clearPromocode" :hasPromocodes="hasPromocodes" :discountValue="discountValue" :discounts="discounts" v-if="hasPromocodes || discounts.length"/> <div class="row row-small"> <div class="col-md-3 col-lg-3 col-xs-5"><div class="text-xs-left" style="width:100%;">{{\'Итого\'|gettext}}:</div></div> <div class="col-md-9 col-lg-9 col-xs-7"><div class="has-text-right has-text-nowrap" style="width:100%;"> {{total - discountValue|currency}} </div></div> </div> </div> </div> </div> <div class="block-item" v-if="step == 1"> <form @submit.prevent="submitCheckout" class="block-form has-rtl"> <button type="submit" ref=\'submit\' style="display: none"></button> <vue-frontend-form-elements :fields="fields" v-if="fields" ref=\'fields1\' :is-loading="isFetching"/> <div v-if="shipping && shipping.is_active"> <div v-if="userShipping"> <div class="form-field"> <label class="label">{{\'Доставка\'|gettext}}<sup class="required">*</sup></label> <div class="radio-list"> <label class="radio is-block" v-if="shipping.use_selfservice" v-for="(c, i) in shipping.shipping"> <input type="radio" name="dvField" :value="\'selfservice:{1}\'|format(i)" v-model="fields.shipping_method.value" required=\'on\' :disabled="isFetching"> {{\'Самовывоз\'|gettext}} <span v-if="c.full" style="opacity: .5;padding-left: 8px">({{c.full}})</span> </label> <label class="radio is-block" v-if="method.on" v-for="method in shipping.custom"> <input type="radio" name="dvField" :value="method.value" v-model="fields.shipping_method.value" required=\'on\' :disabled="isFetching"> {{method.title}} <span style="opacity: .5;padding-left: 8px">({{method.price|currency}})</span> </label> <label class="radio is-block" v-if="shipping.use_zones"> <input type="radio" name="dvField" value="zones" v-model="fields.shipping_method.value" required=\'on\' :disabled="isFetching"> {{title_zones}} </label> </div> </div> </div> <vue-frontend-form-elements ref=\'fields2\' :errors="errors" :fields="shipping.fields" :checkDepends="checkFieldDepends" :is-loading="isFetching" v-if="!isSelfservice && fields.shipping_method.value"/> </div> <vue-frontend-form-elements ref=\'fields3\' :fields="fields_footer" v-if="fields_footer" :is-loading="isFetching"/> </form> </div> <div class="block-item" v-if="step == 2"> <div class="block-text has-rtl products-cart" :style="styleColors"> <div class="row row-small" v-for="(f, k) in cart"> <div class="col-sm-1 col-xs-3"><div class="has-text-centered" style="width:100%"><router-link :to="f.link" class="product-container-outer slider-has-border"><div class=\'product-container\' :class="{\'product-container-empty\': !f.picture}" :style="f.style"></div></router-link></div></div> <div class="col-sm-11 col-xs-9"> <div class="row row-small"> <div class="col-sm col-xs-12 has-xs-mb-1"><router-link :to="f.link">{{f.title}}</router-link><div v-if="f.subtitles" style="font-size: 70%;opacity: .5">{{f.subtitles}}</div></div> <div class="col-sm-2 col-xs-5"> {{f.amount|number}} {{\'шт.\'|gettext}} </div> <div class="col-sm-3 col-md-3 col-lg-2 col-xs-7 has-text-nowrap has-text-right"><div class="has-text-right" style="width:100%"> {{f.price*f.amount|currency}} </div></div> </div> </div> </div> <div class="row row-small"> <div class="col-sm-1 col-xs-3" style="line-height: 0"><div class="product-container-outer slider-has-border"><div class="product-container fa fai fa-user"></div></div></div> <div class="col-sm col-xs-9">{{\'Контакты\'|gettext}}<div style="font-size: 70%;opacity: .5">{{confirm.contacts}}</div></div> </div> <div class="row row-small" v-if="confirm.shipping.is_active"> <div class="col-sm-1 col-xs-3" style="line-height: 0"><div class="product-container-outer slider-has-border"><div class="product-container fa fai fa-truck"></div></div></div> <div class="col-sm-11 col-xs-9"> <div class="row row-small"> <div class="col-sm col-xs-8">{{\'Доставка\'|gettext}}<div style="font-size: 70%;opacity: .5">{{confirm.shipping.details}}</div></div> <div class="col-sm-3 col-xs-4 has-text-nowrap has-text-right"> {{shippingPrice|currency}} </div> </div> </div> </div> <vue-frontend-market-discount @openPromocodeForm="openPromocodeForm" @clearPromocode="clearPromocode" :hasPromocodes="hasPromocodes" :discountValue="discountValue" :discounts="discounts" v-if="hasPromocodes || discounts.length"/> <div class="row row-small"> <div class="col-md-3 col-lg-3 col-xs-5"><div class="text-xs-left" style="width:100%;">{{\'Итого\'|gettext}}:</div></div> <div class="col-md-9 col-lg-9 col-xs-7"><div class="has-text-right has-text-nowrap" style="width:100%;"> {{total+shippingPrice-discountValue|currency}} </div></div> </div> </div> </div> <mx-modal :active.sync="isOpenPromocodeForm" :has-modal-card="true" v-if="data"> <form @submit.prevent="applyPromocode"> <div class="modal-card modal-card-little"> <header class="modal-card-head"><p class="modal-card-title">{{\'Активировать промокод\'|gettext}}</p> <button type="button" class="modal-close is-large" @click="closePromocodeForm"></button></header> <section class="modal-card-body has-text-black"> <div class="field" :class="{\'has-error\': errorPromocode}"> <input type="text" class="input is-large has-rtl" maxlength="16" @keypress="promocodeFilter" @change="promocodeFilterAfter" @keyup="promocodeFilterAfter" placeholder="PROMOCODE" v-model="promocode" :disabled="isCheckingPromocode" ref="inputPromocode"> <p class="help">{{errorPromocode}}</p> </div> </section> <div class="modal-card-foot"> <button type="submit" class="button is-primary" :class="{\'is-loading\': isCheckingPromocode}">{{\'Применить\'|gettext}}</button> </div> </div> </form> </mx-modal> </div>'}),window.$app.defineComponent("frontend","vue-frontend-blocks-products-collections",{data:function(){return{defaults:{view:"row",radius:4,colors:{bg:{active:null,inactive:null},border:{active:null,inactive:null},text:{active:null,inactive:null}}}}},props:["options","page_id","block","data"],mixins:[BlockModel],created:function(){this.block.tariff="business"},mounted:function(){this.checkGUI(!1),this.data||(this.page_id=null)},watch:{page_id:function(){this.checkGUI(!0)}},computed:{o:function(){return _.merge(this.defaults,this.options,!0)},collections:function(){return this.data?this.data.collections:[{collection_id:0,collection:"Коллекция 1"},{collection_id:0,collection:"Коллекция 2"},{collection_id:0,collection:"Коллекция 3"}]},vbar:function(){return"vue-"+(this.data?"frontend":"component")+"-vbar"},styleColors:function(){var e=this.o,t=e.colors;return{"--product-collection-bg-inactive":t.bg.inactive,"--product-collection-bg-active":t.bg.active,"--product-collection-border-inactive":t.border.inactive,"--product-collection-border-active":t.border.active,"--product-collection-text-inactive":t.text.inactive?t.text.inactive:t.bg.inactive?isLightColor(t.bg.inactive)?"#000":"#fff":null,"--product-collection-text-active":t.text.active?t.text.active:t.bg.active?isLightColor(t.bg.active)?"#000":"#fff":null,"--product-collection-radius":e.radius?e.radius+"px":null}}},methods:{collectionLink:function(e){return e?{name:"part",params:{part:"m",page_id:e?e.toString(16):null}}:{name:"part.index",params:{part:"m"}}},checkGUI:function(n){var a=this;this.data&&this.$nextTick(function(){var e,t,i,s;null==a.$refs.collections||"row"!=a.o.view||(e=a.$refs.collections.querySelector(".in"))&&(t=e.offsetLeft-a.$refs.scroll.width/2+e.offsetWidth/2,n?(i=a.$refs.scroll.getWrapper(),s=function(){a.$refs.scroll.getSizes()},scrollIt(t,"x",i,300,"easeOutQuad",s,s)):a.$refs.scroll.scrollTo(t,0))})}},template:'<div class="has-rtl block-form" v-if="_.size(collections)"> <div class="form-field has-compacted-mode" v-if="o.view == \'dropdown\'"> <div class="select is-fullwidth" style="margin-bottom: -1rem"> <select v-model="page_id" @change="router.push(collectionLink(page_id))"> <option :value="null">-- {{\'Все товары\'|gettext}} --</option> <option v-for="c in collections" :value="c.collection_id" v-if="c.collection_id != null">{{c.collection}}</option> </select> </div> </div> <component v-bind:is="vbar" v-if="o.view == \'row\'" class="collection-bar" ref=\'scroll\'> <div class="collection-list" ref=\'collections\' :style="styleColors"> <router-link :to="collectionLink(null)" class="collection-item button" :class="{in: page_id== null}">{{\'Все товары\'|gettext}}</router-link> <router-link :to="collectionLink(c.collection_id)" v-for="c in collections" class="collection-item button" :class="{in: c.collection_id == page_id || ((c.collection_id == null) && !page_id)}">{{c.collection}}</router-link> </div> </component> </div>'}),window.$app.defineComponent("frontend","vue-frontend-blocks-products-description",{data:function(){return{}},props:["options","page_id","block","data"],mixins:[BlockModel],created:function(){this.block.tariff="business"},computed:{product:function(){return this.data?this.data.product:{description:"Описание товара"}}},methods:{prepareHTML:function(e){return this.$parseContacts(this.$typography(e,!0))}},template:'<div class="block-text has-rtl" v-html="prepareHTML(product.description)"></div>'}),window.$app.defineComponent("frontend","vue-frontend-blocks-products-feed",{data:function(){return{isFetching:!1,isFlowFetching:!1,bottom:!1,next:null,mobile:!0,fields:[],defaults:{pictures:{placement:"cover",bg:"#fff"},radius:3,colors:{bg_card:null},cols:{xs:2,sm:3},has_border:!0,style:"standard",grid:"strict",card:[]},filters:{query:""}}},props:["options","page_id","block","data"],mixins:[BlockModel],watch:{bottom:function(e){e&&!this.isFlowFetching&&this.next&&this.fetchData(!1,!0)},page_id:function(){this.clearData(),this.isFetching=!0},data:function(){var e=this;this.isFetching=!1,this.initData(),this.bottom=!1,this.$nextTick(function(){e.bottom=e.bottomVisible()})}},computed:{o:function(){return _.merge(this.defaults,this.options,!0)},styleColors:function(){var e=this.o;return{"--product-card-bg":e.colors.bg_card,"--product-card-radius":e.radius?e.radius+"px":null}},pageKey:function(){return this.page_id},products:function(){return this.data?this.data.products:_.map([1,2,3,4,5,6],function(e){var t=e%3==0;return{product_id:0,title:t?"Название товара со скидкой":"Название товара",price:100,price_compare:t?120:null,sku:"0000"+e}})},columns:function(){var e=this.o.cols,i=this.mobile?e.xs:e.sm;if("flex"!=this.o.grid)return[this.fields];var s=[];return _.each(this.fields,function(e,t){null==s[t%i]&&(s[t%i]=[]),s[t%i].push(e)}),s},colClass:function(){if("strict"==this.o.grid)return"col-xs-12";var e=this.o.cols;return"col-xs-"+12/e.xs+" col-sm-"+12/e.sm},rowClass:function(){if("flex"==this.o.grid)return null;var e=this.o.cols;return"row-products-"+this.o.grid+" is-col-xs-"+e.xs+" is-col-sm-"+e.sm}},mounted:function(){var e=this;this.data&&(this.$nextTick(function(){e.bottom=e.bottomVisible()}),$mx(window).on("scroll",this.scroll),window.$events.on("products:filter",this.onFilter),window.$events.fire("setpage",this)),this.reCheckColumns(),"flex"==this.o.grid&&$mx(window).on("resize orientationchange",this.reCheckColumns)},beforeDestroy:function(){"flex"==this.o.grid&&$mx(window).off("resize orientationchange",this.reCheckColumns),window.$events.off("products:filter",this.onFilter),$mx(window).off("scroll",this.scroll)},created:function(){this.block.tariff="business",this.initData()},methods:{reCheckColumns:function(){this.mobile=this.$device.mobile||$mx(this.$el).closest(".device").length},styleColor:function(e,t,i){var s=2<arguments.length&&void 0!==i?i:null,n={color:s?e.colors[s]:e.color};return"price_compare"!=s||n.color||(n.opacity=.5),"sku"!=t||n.color||(n.opacity=.5),"title"!=t||n.color||(n.opacity=.6),n},styleCardItem:function(e){return{"--product-card-font-weight":[200,400,700][e.weight],"--product-card-text-transform":{u:"uppercase",n:"none"}[e.transform]}},initData:function(){var e,t=this.products;this.data?null!=window.$cacheStorefront&&null!=window.$cacheStorefront[this.pageKey]?(e=window.$cacheStorefront[this.pageKey],this.fields=e.fields,this.next=e.next):(window.$cacheStorefront={},this.prepareFields(t),this.fields=t,window.$cacheStorefront[this.pageKey]=_.clone({fields:this.fields,next:this.next,filters:this.filters})):this.fields=t},onFilter:function(e,t){this.filters=t.filters,this.clearData(),this.fetchData()},clearData:function(){this.fields=[],this.next=0},fetchData:function(e,t){var i=this;t?this.isFlowFetching=!0:this.isFetching=!0,this.$api.get("market/products/list",{params:{collection_id:this.data.collection_id?parseInt(this.data.collection_id,16):null,next:this.next,filters:this.filters}}).then(function(e){"success"==e.result&&(i.prepareFields(e.response.products),i.fields=i.fields.concat(e.response.products),window.$cacheStorefront[i.pageKey]=_.clone({fields:i.fields,next:i.next,filters:i.filters}),i.$nextTick(function(){i.bottomVisible()&&i.next&&i.fetchData(!1,!0)})),i.isFetching=!1,i.isFlowFetching=!1})},prepareFields:function(e){this.next=e.length?e[e.length-1].column_id:0},scroll:function(){this.bottom=this.bottomVisible()},bottomVisible:function(){var e=window.scrollY,t=document.documentElement.clientHeight;return document.documentElement.scrollHeight<t+e+200},classname:function(e){return"product-container "+(e.picture?"picture-"+this.o.pictures.placement:"product-container-empty")},stylesheet:function(e){var t=this.o.pictures.bg,i="contain"==this.o.pictures.placement;if(this.data)return e.picture?"background-image:url(//"+this.$account.storage_domain+"/p/"+e.picture+");background-color: "+this.o.pictures.bg:"";var s=this.data?t:"linear-gradient(0deg, "+t+" 0%, "+t+" 25%, transparent 25%, transparent 25%, transparent 75%, transparent 75%, "+t+" 75%, "+t+" 100%)";return{background:i?s:"var(--background-grey-color)","padding-top":"100%"}}},template:'<div class="has-rtl"> <vue-frontend-loading-blocks :blocks="[\'products\']" v-if="isFetching"/> <div class="row-products row row-small" :class="rowClass" ref="products" :style="styleColors" v-else> <div v-for="items in columns" :class="colClass"> <router-link v-for="f in items" :to="{name: \'part\', params: {part: \'o\', page_id: f.product_id.toString(16)}}" class="item product-container-outer" :class="[{\'slider-has-border\': o.has_border}, \'is-style-\'+((o.style == \'card\' && o.card.length == 0)?\'standard\':o.style)]"> <div :class="classname(f)" :style="stylesheet(f)"> <div v-if="(o.style == \'overlay\') && o.card.length" class="product-container-text has-rtl"> <div v-for="v in o.card" :style="styleCardItem(v)" :data-name="v.name"> <span v-if="v.name == \'title\'">{{f.title}}</span> <span v-if="v.name == \'price\'">{{f.price|currency}}</span> </div> </div> </div> <div v-if="(o.style != \'overlay\') && o.card.length" class="product-container-text has-rtl"> <div v-for="v in o.card" :style="styleCardItem(v)" :data-name="v.name"> <span v-if="v.name == \'title\'" :style="styleColor(v, v.name)">{{f.title}}</span> <span v-if="v.name == \'sku\' && f.sku" :style="styleColor(v, v.name)">{{v.prefix}}{{f.sku}}</span> <span v-if="v.name == \'price\'"><span :style="styleColor(v, v.name, \'price\')">{{f.price|currency}}</span> <span v-if="v.price_compare && f.price_compare" class="is-price strikethrough" style="font-size: 70%;line-height: 1;" :style="styleColor(v, v.name, \'price_compare\')">&nbsp;{{f.price_compare|currency}}&nbsp;</span></span> </div> </div> </router-link> </div> </div> <div class="block-item has-mb-2" v-if="!fields.length && !this.isFetching"> <div class="block-field has-text-centered has-mt-2" style="font-size:2.2em !important;opacity: .5"> {{\'В магазине пока отсутствуют товары\'|gettext}} </div> </div> <div class="border col-xs-12" v-if="isFlowFetching"><div class="loading-overlay loading-block is-active"><div class="loading-icon"></div></div></div> </div>'}),window.$app.defineComponent("frontend","vue-frontend-blocks-products-filters",{data:function(){return{filters:{query:""}}},props:["options","page_id","block"],mixins:[BlockModel],methods:{onFilter:_.debounce(function(){this.changeFilter()},700),changeFilter:function(){$events.fire("search",{query:this.filters.query}),window.$events.fire("products:filter",{filters:this.filters})},clearFilter:function(){this.filters.query="",this.changeFilter()}},computed:{pageKey:function(){return this.page_id}},created:function(){this.block.tariff="business",null!=window.$cacheStorefront&&null!=window.$cacheStorefront[this.pageKey]&&(this.filters=window.$cacheStorefront[this.pageKey].filters)},template:'<div class="has-rtl block-form"> <div class="form-field has-compacted-mode"> <div class="control has-icons-right is-clearfix has-products-search-icon"> <input type="text" inputmode="search" :placeholder="\'Поиск по названию\'|gettext" v-model="filters.query" @input="onFilter" class="has-rtl" style="margin-bottom: 0 !important"> <span class="icon is-right is-clickable" @click="clearFilter" v-if="filters.query"><i class="fai fa-circle-times"></i></span> </div> </div> </div>'}),window.$app.defineComponent("frontend","vue-frontend-blocks-products-header",{data:function(){return{variants_value:"",variants_offers:{},options_selected:[],defaults:{items:[{name:"title",weight:1,transform:"n",size:"h2",colors:{outstock:null}},{name:"price",price_compare:!0,weight:2,size:"h3",colors:{price:null,price_compare:null}},{name:"sku",weight:2,transform:"n",size:"h3",colors:{text:null}}]},variants:[],min_price:0,max_price:0}},props:["options","page_id","block","data"],mixins:[BlockModel],created:function(){this.block.tariff="business",window.$events.on("products:setoffer",this.setOffer),this.initData()},beforeDestroy:function(){window.$events.off("products:setoffer",this.setOffer),$mx(window).off("scroll",this.scroll)},computed:{o:function(){return _.merge(this.defaults,this.options,!0)},product:function(){return this.data?this.data.product:{title:"Название товара",price:100,price_compare:120,offer_id:0,sku:"#ABC"}},price_html:function(){return _.size(this.variants_offers)?null!=this.variants_offers[this.variants_value]?this.$currency(this.variants_offers[this.variants_value].price):(this.min_price==this.max_price?"":this.$currency(this.min_price)+'<span style="opacity:.5;" class="is-text">&nbsp;—&nbsp;</span>')+this.$currency(this.max_price):this.$currency(this.product.price)},price:function(){return _.size(this.variants_offers)?null!=this.variants_offers[this.variants_value]?this.variants_offers[this.variants_value].price:this.min_price==this.max_price?this.max_price:null:this.product.price},price_compare:function(){return this.product.price_compare?_.size(this.variants_offers)?null==this.variants_offers[this.variants_value]||this.variants_offers[this.variants_value].price<this.product.price_compare?this.product.price_compare:null:this.product.price_compare>this.product.price?this.product.price_compare:null:null},sku:function(){return _.size(this.variants_offers)&&null!=this.variants_offers[this.variants_value]&&this.variants_offers[this.variants_value].sku?this.variants_offers[this.variants_value].sku:this.product.sku},hasAvailability:function(){return _.size(this.variants_offers)?amount=null!=this.variants_offers[this.variants_value]&&null!==this.variants_offers[this.variants_value].amount:null!==this.product.amount},availability:function(){if(!_.size(this.variants_offers))return!(null!==this.product.amount&&!this.product.amount);var e=null!=this.variants_offers[this.variants_value]?this.variants_offers[this.variants_value].amount:null;return!(null!==e&&!e)},offer_id:function(){if(!_.size(this.variants_offers)&&!this.variants.length)return this.product.offer_id;if(_.size(this.variants_offers))return null!=this.variants_offers[this.variants_value]?this.variants_offers[this.variants_value].offer_id:0;var t=!0;return _.each(this.variants,function(e){return t&=""!==e.value}),t?this.product.offer_id+"#"+this.variants_value:null}},methods:{styleColor:function(e,t,i){var s={color:e.colors[t]};return"price_compare"!=t||s.color||(s.opacity=.5),"sku"!=i||s.color||(s.opacity=.5),s},styleCardItem:function(e){return{"font-weight":[200,400,700][e.weight],"text-transform":{u:"uppercase",n:"none"}[e.transform],opacity:(100-e.transparent)/100}},initData:function(){this.variants_value="",this.min_price=Number.MAX_SAFE_INTEGER,this.max_price=0,window.$events.fire("setpage",this)},setOffer:function(e,t){Object.assign(this,t)}},template:'<div class="has-rtl"> <div v-for="v in o.items"> <component v-bind:is="(v.size == \'h3\')?\'h4\':v.size" class="is-heading" :class="{\'has-mb-1\': v.name == \'title\'}" :style="styleCardItem(v)"> <span v-if="v.name == \'title\'">{{product.title}}<span v-if="data && hasAvailability && !availability" class="has-ml-1 is-outstock" :style="styleColor(v, \'outstock\', v.name)">&nbsp;/&nbsp;{{\'Нет в наличии\'|gettext}}</span></span> <span v-if="v.name == \'sku\' && product.sku" class="is-sku" :style="styleColor(v, \'text\', v.name)"><span style="text-transform: initial">{{v.prefix}}</span>{{sku}}</span> <span v-if="v.name == \'price\'"> <span class="is-price" v-html="price_html" :style="styleColor(v, \'price\', v.name)"></span> <span class="has-ml-1 strikethrough" style="font-size: 70%" :style="styleColor(v, \'price_compare\', v.name)" v-if="price_compare && (price < price_compare)">&nbsp;{{price_compare|currency}}&nbsp;</span> </span> </component> </div> </div>'}),window.$app.defineComponent("frontend","vue-frontend-blocks-products-offers",{data:function(){return{offers_checked:{},variants_value:"",min_price:0,max_price:0,defaults:{view:"row",show_title:!0,colors:{bg:{active:null,inactive:null},text:{active:null,inactive:null},border:{active:null,inactive:null}}}}},props:["options","page_id","block","data"],mixins:[BlockModel],created:function(){this.block.tariff="business",window.$events.on("products:clearform",this.clearForm),this.initData()},beforeDestroy:function(){window.$events.off("products:clearform",this.clearForm)},computed:{o:function(){return _.merge(this.defaults,this.options,!0)},variants:function(){return this.data?this.data.variants:[{variant_id:0,variant_title:"Свойство",variant_values:["Значение 1","Значение 2","Значение 3","Значение 4","Значение 5"]}]},variantsAll:function(){return!this.data||0==_.size(this.data.variants_offers)},vbar:function(){return"row"==this.o.view?"vue-"+(this.data?"frontend":"component")+"-vbar":"div"},styleColors:function(){var e=this.o.colors;return{"--product-offers-bg-inactive":e.bg.inactive,"--product-offers-bg-active":e.bg.active,"--product-offers-border-inactive":e.border.inactive,"--product-offers-border-active":e.border.active,"--product-offers-text-inactive":e.text.inactive?e.text.inactive:e.bg.inactive?isLightColor(e.bg.inactive)?"#000":"#fff":null,"--product-offers-text-active":e.text.active?e.text.active:e.bg.active?isLightColor(e.bg.active)?"#000":"#fff":null}}},methods:{clearForm:function(){_.each(this.data.variants,function(e){e.value=""}),this.changeVariant()},initData:function(){var n,a=this;this.variants_value="",this.min_price=Number.MAX_SAFE_INTEGER,this.max_price=0,this.variantsAll?_.each(this.variants,function(e){a.$set(e,"value",""),e.variant_values=_.map(e.variant_values,function(e,t){return{k:parseInt(t),v:e}})}):(n={},_.each(this.data.variants_offers,function(e,t){a.min_price=Math.min(a.min_price,e.price),a.max_price=Math.max(a.max_price,e.price);var s=t.split(":");for(i=0;i<s.length;i+=2)null==n[s[i]]&&(n[s[i]]={}),n[s[i]][parseInt(s[i+1])]=!0}),_.each(this.data.variants,function(i){a.$set(i,"value","");i.variant_values=_.filter(_.map(i.variant_values,function(e,t){return(""==e||null!=n[i.variant_id][t])&&{k:parseInt(t),v:e}}))})),this.changeVariant()},changeVariant:function(){var l=this;this.variants_value=_.map(this.variants,function(e){return e.variant_id+":"+e.value}).join(":"),this.offers_checked={},this.variantsAll||_.each(this.data.variants,function(t,e){var s=[];for(i in _.each(l.data.variants,function(e){e.variant_id==t.variant_id?s.push(e.variant_id+":[0-9]+"):s.push(e.variant_id+":"+(""!==e.value?e.value:"[0-9]+"))}),s=new RegExp(s.join(":"),"i"),l.data.variants_offers)if(s.test(i)){var n=i.split(":");for(j=0;j<n.length;j++){var a=parseInt(n[j]),o=parseInt(n[j+1]);t.variant_id==n[j]&&(null==l.offers_checked[a]&&(l.offers_checked[a]=[]),-1==l.offers_checked[a].indexOf(o)&&l.offers_checked[a].push(o)),j++}}}),this.data&&window.$events.fire("products:setoffer",{min_price:this.min_price,max_price:this.max_price,variants_offers:this.data.variants_offers,variants_value:this.variants_value,variants:this.data.variants})},setVariant:function(e,t){e.value=e.value===t.k?"":t.k,this.changeVariant()}},template:'<div v-if="_.size(variants)" class="block-form"> <div class="form-field has-compacted-mode" v-for="(f, i) in variants" :class="{\'has-mb-2\': i < _.size(variants) - 1, \'is-empty\': !f.value}"> <label class="label has-text-weight-semibold" v-if="o.show_title">{{f.variant_title}}</label> <component v-bind:is="vbar" class="offers-bar" :style="styleColors" :class="{\'is-multiline\': o.view == \'tags\'}" ref=\'scroll\' v-if="o.view != \'dropdown\'"> <div class="offers-list"> <a class="button" v-for="(v, i) in f.variant_values" @click="setVariant(f, v)" :data-a="v.k" :data-b="f.value" :class="{in: v.k === f.value || (!data && !i), disabled: (!variantsAll && (offers_checked[f.variant_id] == undefined || offers_checked[f.variant_id].indexOf(v.k) == -1))}">{{v.v}}</a> </div> </component> <div class="select" v-if="o.view == \'dropdown\'"><select @change="changeVariant" v-model="f.value" :class="{\'has-text-grey\': f.value === \'\'}"><option value="">{{\'-- Не выбрано --\'|gettext}}</option> <option :value="v.k" v-for="v in f.variant_values" :disabled="!variantsAll && (offers_checked[f.variant_id] == undefined || offers_checked[f.variant_id].indexOf(v.k) == -1)">{{v.v}}</option> </select></div> </div> </div>'}),window.$app.defineComponent("frontend","vue-frontend-blocks-products-options",{data:function(){return{options_selected:[]}},props:["options","page_id","block","data"],mixins:[BlockModel],watch:{options_selected:function(){window.$events.fire("products:setoffer",{options_selected:this.options_selected})}},computed:{opts:function(){return this.data?this.data.options:[{title:"Опция 1",price:100},{title:"Опция 2",price:200}]}},created:function(){this.block.tariff="business",window.$events.on("products:clearform",this.clearForm)},beforeDestroy:function(){window.$events.off("products:clearform",this.clearForm)},methods:{clearForm:function(){this.options_selected=[]}},template:'<div v-if="_.size(opts)" class="block-form"> <div class="form-field"> <div class="checkbox-list" id=\'productOptions\'> <label class="is-block checkbox" v-for="(f, option_id) in opts"> <input type="checkbox" :value="option_id" v-model="options_selected"> {{f.title}} <span style="opacity:.5">(<span v-if="f.price> 0">+</span>{{f.price|currency}})</span> </label> </div> </div> </div>'}),window.$app.defineComponent("frontend","vue-frontend-blocks-products-pictures",{data:function(){return{index:0,defaults:{pictures:{placement:"cover",bg:"#fff"},remove_border:!1,is_desktop_fullwidth:!1,indicator:{placement:"outside",style:"dots"}}}},props:["options","page_id","block","data"],mixins:[BlockModel],created:function(){this.block.tariff="business"},computed:{o:function(){return _.merge(this.defaults,this.options,!0)},pictures:function(){return this.data?this.data.product.pictures:[null,null,null]}},methods:{urlPicture:function(e){var t=this.o.pictures.bg,i="contain"==this.o.pictures.placement;if(this.data)return{"background-image":"url(//"+this.$account.storage_domain+"/p/"+e+")","background-color":i?t:null,"padding-top":"100%"};var s=this.data?t:"linear-gradient(0deg, "+t+" 0%, "+t+" 25%, transparent 25%, transparent 25%, transparent 75%, transparent 75%, "+t+" 75%, "+t+" 100%)";return{background:i?s:null,"padding-top":"100%"}}},template:'<div class="has-rtl"> <div class="block-slider" :class="[{\'is-allow-fullwidth\': o.is_desktop_fullwidth}, \'is-indicator-\'+o.indicator.placement, \'is-indicator-\'+o.indicator.style]"> <div class="block-slider-inner"> <div style="transform: translate(0, 0)" v-if="pictures.length"> <div class="slider slider-pictures" :class="{\'slider-has-border\': !o.remove_border}" data-allow-zoom="true"> <div class="slider-inner"> <div class="slider-slide" v-for="(f, i) in pictures" :class="{active: index== i}"><div :class="[\'picture-container product-container\', \'picture-\'+o.pictures.placement, f?null:\'product-container-empty\']" :style="urlPicture(f)"><div></div></div></div> </div> <div class="slider-nav" :class="{\'is-hidden\': pictures.length == 1 || o.indicator.style == \'none\'}"> <div class="slider-dot" :class="{active: i== 0}" v-for="(f, i) in pictures"></div> </div> </div> </div> </div> </div> </div>'}),window.$app.defineComponent("frontend","vue-frontend-blocks-socialnetworks",{data:function(){return{loading:null,values:null,v:null,defaults:{socials_style:{layout:"full",shape:"brand",design:"brand",colors:{bg:null,text:null,icon:null}},items:[]}}},props:{options:Object,block:Object,page_id:Number,section:Object,theme:Object,mode:{default:"view"}},mixins:[BlockModel],created:function(){this.initData(),this.block.tariff="plus"},watch:{values:function(){this.initData()}},methods:{initData:function(){this.v=this.values.socials_style},iconPaths:function(e){var t="";if(null!=e.ip)for(i=1;i<=e.ip;i++)t+='<em class="p'+i+'"></em>';return t},click:function(e,t){var i=this;this.loading=t.n;var s=this.block.stat[t.n].split("."),n=[{event:"taplink:socialnetworks",param:s[s.length-1]+":"+t.v},{event:"taplink:socialnetworks:"+s[s.length-1],param:t.v}];if($events.fire("tap",{page_id:this.page_id,block_id:this.block.block_id,slot:this.block.slot[t.n],stat:this.block.block_id+"."+this.block.stat[t.n],data:n,addons:null!=this.values.data&&null!=this.values.data[t.n]?this.values.data[t.n]:null}),setTimeout(function(){i.loading=null},2e3),e.target.href==t.link.b||this.$device.isOpera)return!0;e.preventDefault(),this.$links.deeplink(t.link)},link:function(e){return"view"==this.mode?this.$links.application(e.link):null},classname:function(e){return["button btn-link is-service-"+e.i,"is-layout-"+this.v.layout,this.isFlat?null:"btn-socials","is-shape-"+this.v.shape,"is-design-"+this.v.design,"full"==this.v.layout?"btn-link-styled":null]}},computed:{isFlat:function(){return"full"==this.v.layout&&"flat"==this.v.shape},stylesheet:function(){var e=this.theme,t=0;if(100==(t=null!=this.section&&null!=this.section.link&&null!=this.section.link.transparent?this.section.link.transparent:e.link.transparent)&&(t=0),"custom"!=this.v.design)return null;switch(this.v.shape){case"icon":return{"--icon-text":this.v.colors.icon};default:return{"--link-background":transparentColor(t,this.v.colors.bg),"--link-background-digs":hexToRgb(this.v.colors.bg),"--link-border-color":this.v.colors.bg,"--color-text":this.v.colors.text}}}},template:'<div class="socials"> <div class="row row-small"> <div :class="{\'col-shrink\': v.layout == \'square\', \'col-xs\': v.layout != \'full\', \'col-xs-12\': v.layout == \'full\'}" v-for="l in values.items"> <component v-bind:is="(mode == \'view\')?\'a\':\'div\'" :href="link(l)" @click="click($event, l)" target="_top" :aria-label="l.t" :class="classname(l)" :style="stylesheet"> <i :class="\'fa fab fa-\'+l.i" v-if="!isFlat" v-html="iconPaths(l)"></i> <div v-if="v.layout == \'full\'" v-html="$typography(l.t, true)"></div> </component> </div> </div> </div>'}),window.$app.defineComponent("frontend","vue-frontend-blocks-text",{data:function(){return{defaults:{text:"",text_size:"md",text_align:"left",color:"",font:""}}},props:{options:Object,theme:Object,mode:{default:"view"}},mixins:[BlockModel],computed:{component:function(){return this.isHeading?this.values.text_size:"div"},isHeading:function(){return"h"==this.values.text_size[0]},html:function(){var e="view"==this.mode?"a":"span";return this.isPlaceholder?this.$gettext("Редактировать текст"):this.$parseContacts(this.$typography(this.values.text),e)},isEmpty:function(){return""==this.values.text.trim().replace(/<br>/g,"")},isPlaceholder:function(){return this.isEmpty&&"edit"==this.mode},style:function(){var e={"text-align":this.values.text_align,"line-height":FontsFactory.getLineHeight(this.values.text_size),"font-size":FontsFactory.getTextSize(this.values.text_size),color:this.values.color+"!important"};return this.values.font&&Object.assign(e,{"font-family":FontsFactory.getFont(this.values.font)+" !important","font-weight":"h"==this.values.text_size[0]&&null!=this.theme.heading&&null!=this.theme.heading.weight?FontsFactory.getWeight(this.values.font,this.theme.heading.weight):null}),this.isPlaceholder&&(e.opacity=.3),FontsFactory.check(),e}},template:'<component v-bind:is="component" class="block-text has-rtl" :class="{\'is-heading\': this.values.text_size[0] == \'h\'}" :style=\'style\' v-html="html"></component>'}),window.$app.defineComponent("frontend","vue-frontend-blocks-timer",{data:function(){return{countdown:0,defaults:{type:"1",timer:{1:{date:"",time:""},2:{days:"",hours:"",minutes:"",expires:""},3:{time:""}}}}},props:["options","block","block_id","page_id"],mixins:[BlockModel],watch:{values:function(){this.rebuild()}},created:function(){this.rebuild(),this.block.tariff="business"},methods:{rebuild:function(){var e,t,i,s=this.values;2==s.type&&(e="timer"+this.block_id,t=Math.round(new Date/1e3),i=Cookies.get(e),s.tms=Math.min(s.tms,8639999),i?s.tms=i-t:Cookies.set(e,s.tms+t,{maxAge:t+86400*s.expires,path:s.path?s.path:"/"})),s.tms<0&&(s.tms=0),this.countdown=s.tms}},template:'<div class="block-form"> <center><vue-blocks-flipclock-countdown :countdown="countdown"/></center> </div>'}),window.$app.defineComponent("frontend","vue-frontend-blocks-video",{data:function(){return{player:null,isStarted:!1,provider:null}},props:{options:Object,mode:{default:"view"},block:Object},mixins:[BlockModel],created:function(){this.block.tariff="pro",this.provider=VideoHelper.getProvider(this.values,"view"==this.mode),this.provider&&(null!=this.provider.t?!this.values.is_autoplay&&this.values.poster||this.start():(this.values.embeded=this.provider.embeded(this.provider.match,this.$account.language_code),this.values.handler="embeded"))},computed:{handler:function(){return null!=this.values.handler?this.values.handler:"embeded"},link:function(){return(new RegExp("[?|&]static=1","i").test(location.search)||"edit"==this.mode)&&this.values.embeded?this.values.embeded.replace("autoplay=1",""):this.values.embeded},sources:function(){return[{src:this.values.url,type:this.values.type}]},poster:function(){return this.values.poster?"//"+this.$account.storage_domain+"/p/"+this.options.poster.filename:null}},beforeDestroy:function(){this.player&&this.player.dispose()},methods:{start:function(){var i=this;this.isStarted||(this.isStarted=!0,this.$nextTick(function(){var e=[];i.provider.s&&e.push(i.provider.s),$mx.lazy("//cdn.jsdelivr.net/combine/npm/video.js@7.1.0/dist/video.min.js,npm/videojs-resolution-switcher@0.4.2/lib/videojs-resolution-switcher.min.js,npm/videojs-playbackrate-adjuster","videoplayer.css",function(){$mx.lazy(e,[],function(){var e=[{src:i.values.url,type:"function"==typeof i.provider.t?i.provider.t(i.provider.match[1]):i.provider.t}],t={poster:i.values.poster,controls:!0,autoplay:!1,playbackRates:[.5,1,1.5,2,4],plugins:{videoJsResolutionSwitcher:{dynamicLabel:!0}},controlBar:{volumePanel:{inline:!1}},sources:e};null!=i.provider.techOrder&&(t.techOrder=i.provider.techOrder),i.player=videojs(i.$refs.videoPlayer,t),i.values.is_autoplay&&"view"==i.mode&&i.player.play()})})}))}},template:'<div class="video-container" :class="provider?(\'is-\'+provider.name):null"> <iframe frameborder="0" :src="link" allowfullscreen="1" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" v-if="handler == \'embeded\'"></iframe> <div class="video-container-poster" :data-src="poster" @click="start" :class="{\'is-started\': isStarted, lazy: poster, \'lazy-force\': poster && (mode == \'edit\')}" v-else> <video ref="videoPlayer" class="video-js vjs-fill" :class="{\'vjs-hidden-control-bar\': values.is_autohide}" v-if="isStarted"><div class="video-container-poster-play"></div></video> <div class="video-container-poster-play" v-else></div> </div> </div>'}),window.$app.defineComponent("frontend","vue-frontend-brandlink",{data:function(){return{index:0}},computed:{brandlink:function(){return"https://"+this.$account.domain+"?utm_source=pages&utm_medium="+this.$account.nickname},isAllow:function(){this.index;var e=this.$router.currentRoute;return!(this.$account.is_hidelink||this.$account.lock_message||-1!=["part","part.index"].indexOf(e.name)&&-1!=["m","b","o"].indexOf(e.params.part))},title:function(){var e=this.$account.domain;return e[0].toUpperCase()+e.slice(1)}},created:function(){var e=this;$events.on("contentupdated",function(){e.index++})},template:'<aside v-if="isAllow"> <a :href=\'brandlink\' target="_blank" rel="noopener" class="footer-link"> {{\'Сделано на\'|gettext}} <svg version="1.1" width="16px" height="16px" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 76 76" xml:space="preserve" style="fill:#000;position:relative;top:3px;margin:0 2px"> <g><path d="M38,0C17,0,0,17,0,38s17,38,38,38s38-17,38-38S59,0,38,0z M38,72C19.2,72,4,56.8,4,38S19.2,4,38,4s34,15.2,34,34S56.8,72,38,72z M57.5,38c0,1.1-0.9,2-2,2h-35c-1.1,0-2-0.9-2-2s0.9-2,2-2h35C56.6,36,57.5,36.9,57.5,38z M57.5,50c0,1.1-0.9,2-2,2h-35c-1.1,0-2-0.9-2-2s0.9-2,2-2h35C56.6,48,57.5,48.9,57.5,50z M57.5,26c0,1.1-0.9,2-2,2h-35c-1.1,0-2-0.9-2-2s0.9-2,2-2h35C56.6,24,57.5,24.9,57.5,26z"/></g> </svg> <span>{{title}}</span> </a> </aside>'}),window.$app.defineComponent("frontend","vue-frontend-components-clockpicker-face",{props:{pickerSize:Number,min:Number,max:Number,double:Boolean,value:Number,faceNumbers:Array,disabledValues:Function},data:function(){return{isDragging:!1,inputValue:this.value,prevAngle:720}},computed:{count:function(){return this.max-this.min+1},countPerRing:function(){return this.double?this.count/2:this.count},radius:function(){return this.pickerSize/2},outerRadius:function(){return this.radius-5-20},innerRadius:function(){return Math.max(.6*this.outerRadius,this.outerRadius-5-40)},degreesPerUnit:function(){return 360/this.countPerRing},degrees:function(){return this.degreesPerUnit*Math.PI/180},handRotateAngle:function(){for(var e=this.prevAngle;e<0;)e+=360;var t=this.calcHandAngle(this.displayedValue),i=this.shortestDistanceDegrees(e,t);return this.prevAngle+i},handScale:function(){return this.calcHandScale(this.displayedValue)},handStyle:function(){return{transform:"rotate("+this.handRotateAngle+"deg) scaleY("+this.handScale+")",transition:".3s cubic-bezier(.25,.8,.50,1)"}},displayedValue:function(){return null==this.inputValue?this.min:this.inputValue}},watch:{value:function(e){e!==this.inputValue&&(this.prevAngle=this.handRotateAngle),this.inputValue=e}},methods:{isDisabled:function(e){return this.disabledValues&&this.disabledValues(e)},euclidean:function(e,t){var i=t.x-e.x,s=t.y-e.y;return Math.sqrt(i*i+s*s)},shortestDistanceDegrees:function(e,t){var i=(t-e)%360,s=180-Math.abs(Math.abs(i)-180);return(360+i)%360<180?s:-1*s},coordToAngle:function(e,t){var i=2*Math.atan2(t.y-e.y-this.euclidean(e,t),t.x-e.x);return Math.abs(180*i/Math.PI)},getNumberTranslate:function(e){var t=this.getNumberCoords(e);return"translate("+t.x+"px, "+t.y+"px)"},getNumberCoords:function(e){var t=this.isInnerRing(e)?this.innerRadius:this.outerRadius;return{x:Math.round(t*Math.sin((e-this.min)*this.degrees)),y:Math.round(-t*Math.cos((e-this.min)*this.degrees))}},getFaceNumberClasses:function(e){return{active:e.value===this.displayedValue,disabled:this.isDisabled(e.value)}},isInnerRing:function(e){return this.double&&e-this.min>=this.countPerRing},calcHandAngle:function(e){var t=this.degreesPerUnit*(e-this.min);return this.isInnerRing(e)&&(t-=360),t},calcHandScale:function(e){return this.isInnerRing(e)?this.innerRadius/this.outerRadius:1},onMouseDown:function(e){e.preventDefault(),this.isDragging=!0,this.onDragMove(e)},onMouseUp:function(){this.isDragging=!1,this.isDisabled(this.inputValue)||this.$emit("change",this.inputValue)},onDragMove:function(e){var t,i,s,n,a,o,l,r,c,d;e.preventDefault(),!this.isDragging&&"click"!==e.type||(i=(t=this.$refs.clock.getBoundingClientRect()).width,s=t.top,n=t.left,o={x:i/2,y:-i/2},l={x:(a="touches"in e?e.touches[0]:e).clientX-n,y:s-a.clientY},r=Math.round(this.coordToAngle(o,l)+360)%360,c=this.double&&this.euclidean(o,l)<(this.outerRadius+this.innerRadius)/2-16,d=Math.round(r/this.degreesPerUnit)+this.min+(c?this.countPerRing:0),r>=360-this.degreesPerUnit/2&&(d=c?this.max:this.min),this.update(d))},update:function(e){this.inputValue===e||this.isDisabled(e)||(this.prevAngle=this.handRotateAngle,this.inputValue=e,this.$emit("input",e))}},template:'<div class="b-clockpicker-face" @mousedown="onMouseDown" @mouseup="onMouseUp" @mousemove="onDragMove" @touchstart="onMouseDown" @touchend="onMouseUp" @touchmove="onDragMove"> <div class="b-clockpicker-face-outer-ring" ref="clock"> <div class="b-clockpicker-face-hand" :style="handStyle"/> <span v-for="(num, index) of faceNumbers" :key="index" class="b-clockpicker-face-number" :class="getFaceNumberClasses(num)" :style="{ transform: getNumberTranslate(num.value) }"> <span>{{ num.label }}</span> </span> </div> </div>'}),window.$app.defineComponent("frontend","vue-frontend-components-clockpicker",{props:{pickerSize:{type:Number,default:290},hourFormat:{type:String,default:"12",validator:function(e){return"24"===e||"12"===e}},mobileNative:{type:Boolean,default:!0},incrementMinutes:{type:Number,default:5},autoSwitch:{type:Boolean,default:!0},type:{type:String,default:"is-primary"},position:String,editable:Boolean,rounded:Boolean,disabled:Boolean,inline:Boolean,minTime:Date,maxTime:Date,placeholder:String,loading:Boolean,useHtml5Validation:{type:Boolean,default:!0},timeFormatter:{type:Function,default:function(e,t){var i,s,n,a,o,l;return s=t,n=(i=e).getHours(),a=i.getMinutes(),o=i.getSeconds(),l="","12"===s.hourFormat&&(l=" "+(n<12?AM:PM),12<n?n-=12:0===n&&(n=12)),s.pad(n)+":"+s.pad(a)+(s.enableSeconds?":"+s.pad(o):"")+l}}},data:function(){return{isSelectingHour:!0,isDragging:!1,_isClockpicker:!0,dateSelected:this.value,hoursSelected:null,minutesSelected:null,secondsSelected:null,meridienSelected:null}},computed:{computedValue:{get:function(){return this.dateSelected},set:function(e){this.dateSelected=e,this.$emit("input",e)}},hours:function(){for(var e=[],t=this.isHourFormat24?24:12,i=0;i<t;i++){var s=i,n=s;this.isHourFormat24||(n=s=i+1,this.meridienSelected===this.AM?12===s&&(s=0):this.meridienSelected===this.PM&&12!==s&&(s+=12)),e.push({label:this.formatNumber(n),value:s})}return e},minutes:function(){for(var e=[],t=0;t<60;t+=this.incrementMinutes)e.push({label:this.formatNumber(t),value:t});return e},seconds:function(){for(var e=[],t=0;t<60;t+=this.incrementSeconds)e.push({label:this.formatNumber(t),value:t});return e},meridiens:function(){return[AM,PM]},hoursDisplay:function(){if(null==this.hoursSelected)return"--";if(this.isHourFormat24)return this.pad(this.hoursSelected);var e=this.hoursSelected;return this.meridienSelected===this.PM&&(e-=12),0===e&&(e=12),e},minutesDisplay:function(){return null==this.minutesSelected?"--":this.pad(this.minutesSelected)},minFaceValue:function(){return this.isSelectingHour&&!this.isHourFormat24&&this.meridienSelected===this.PM?12:0},maxFaceValue:function(){return this.isSelectingHour?this.isHourFormat24||this.meridienSelected!==this.AM?23:11:59},faceFormatter:function(){return this.isSelectingHour&&!this.isHourFormat24?function(e){return e}:this.formatNumber},faceSize:function(){return this.pickerSize-24},faceDisabledValues:function(){return this.isSelectingHour?this.isHourDisabled:this.isMinuteDisabled},isMobile:function(){return this.mobileNative&&screen.width<768},isHourFormat24:function(){return"24"===this.hourFormat}},methods:{toggle:function(){},onClockInput:function(e){this.isSelectingHour?(this.hoursSelected=e,this.onHoursChange(e)):(this.minutesSelected=e,this.onMinutesChange(e))},onHoursChange:function(e){!this.minutesSelected&&this.defaultMinutes&&(this.minutesSelected=this.defaultMinutes),!this.secondsSelected&&this.defaultSeconds&&(this.secondsSelected=this.defaultSeconds),this.updateDateSelected(parseInt(e,10),this.minutesSelected,this.enableSeconds?this.secondsSelected:0,this.meridienSelected)},onMinutesChange:function(e){!this.secondsSelected&&this.defaultSeconds&&(this.secondsSelected=this.defaultSeconds),this.updateDateSelected(this.hoursSelected,parseInt(e,10),this.enableSeconds?this.secondsSelected:0,this.meridienSelected)},onSecondsChange:function(e){this.updateDateSelected(this.hoursSelected,this.minutesSelected,parseInt(e,10),this.meridienSelected)},updateDateSelected:function(e,t,i,s){var n;null!=e&&null!=t&&(!this.isHourFormat24&&null!==s||this.isHourFormat24)&&(n=null,this.computedValue&&!isNaN(this.computedValue)?n=new Date(this.computedValue):(n=new Date).setMilliseconds(0),n.setHours(e),n.setMinutes(t),n.setSeconds(i),this.computedValue=new Date(n.getTime()))},formatValue:function(e){return e&&!isNaN(e)?this.timeFormatter(e,this):null},onClockChange:function(){this.autoSwitch&&this.isSelectingHour&&(this.isSelectingHour=!this.isSelectingHour)},onMeridienClick:function(e){this.meridienSelected!==e&&(this.meridienSelected=e,this.onMeridienChange(e))},handleOnFocus:function(){this.onFocus(),this.openOnFocus&&this.toggle(!0)},onChangeNativePicker:function(e){var t,i,s=e.target.value;s?(t=null,this.computedValue&&!isNaN(this.computedValue)?t=new Date(this.computedValue):(t=new Date).setMilliseconds(0),i=s.split(":"),t.setHours(parseInt(i[0],10)),t.setMinutes(parseInt(i[1],10)),t.setSeconds(i[2]?parseInt(i[2],10):0),this.computedValue=new Date(t.getTime())):this.computedValue=null},formatNumber:function(e,t){return this.isHourFormat24||t?this.pad(e):e},onBlur:function(e){this.isFocused=!1,this.$emit("blur",e),this.checkHtml5Validity()},onFocus:function(e){this.isFocused=!0,this.$emit("focus",e)},pad:function(e){return(e<10?"0":"")+e},checkHtml5Validity:function(){var e=this;if(this.useHtml5Validation&&void 0!==this.$refs[this.$data._elementRef]){var t=this.$el.querySelector(this.$data._elementRef),i=null,s=null,n=!0;return t.checkValidity()||(i="is-danger",s=t.validationMessage,n=!1),this.isValid=n,this.$nextTick(function(){e.parentField&&(e.parentField.type||(e.parentField.newType=i),e.parentField.message||(e.parentField.newMessage=s))}),this.isValid}},formatHHMMSS:function(e){var t=new Date(e);if(!e||isNaN(t))return"";var i=t.getHours(),s=t.getMinutes(),n=t.getSeconds();return this.formatNumber(i)+":"+this.formatNumber(s,!0)+":"+this.formatNumber(n,!0)}},template:'<div class="b-clockpicker clockpicker-container"> <div class="control has-icons-right" :class="{\'is-inline-mode\': !isMobile || inline}"> <vue-frontend-components-dropdown v-if="!isMobile || inline" ref="dropdown" :position="position" :disabled="disabled" :inline="inline"> <input v-if="!inline" ref="input" slot="trigger" autocomplete="off" type="text" :value="formatValue(computedValue)" :placeholder="placeholder" :loading="loading" :disabled="disabled" :readonly="!editable" :rounded="rounded" v-bind="$attrs" :use-html5-validation="useHtml5Validation" @click.native.stop="toggle(true)" @keyup.native.enter="toggle(true)" @change.native="onChangeNativePicker" @focus="handleOnFocus" @blur="onBlur() && checkHtml5Validity()"/> <div class="card" :disabled="disabled" custom> <header v-if="inline" class="card-header"> <div class="b-clockpicker-header card-header-title"> <div class="b-clockpicker-time"> <span class="b-clockpicker-btn" :class="{ active: isSelectingHour }" @click="isSelectingHour = true">{{ hoursDisplay }}</span> <span>:</span> <span class="b-clockpicker-btn" :class="{ active: !isSelectingHour }" @click="isSelectingHour = false">{{ minutesDisplay }}</span> </div> <div v-if="!isHourFormat24" class="b-clockpicker-period"> <div class="b-clockpicker-btn" :class="{ active: meridienSelected== AM }" @click="onMeridienClick(AM)">am</div> <div class="b-clockpicker-btn" :class="{ active: meridienSelected== PM }" @click="onMeridienClick(PM)">pm</div> </div> </div> </header> <div class="card-content"> <div class="b-clockpicker-body" :style="{ width: faceSize + \'px\', height: faceSize + \'px\' }"> <div v-if="!inline" class="b-clockpicker-time"> <div class="b-clockpicker-btn" :class="{ active: isSelectingHour }" @click="isSelectingHour = true">Hours</div> <span class="b-clockpicker-btn" :class="{ active: !isSelectingHour }" @click="isSelectingHour = false">Min</span> </div> <div v-if="!isHourFormat24 && !inline" class="b-clockpicker-period"> <div class="b-clockpicker-btn" :class="{ active: meridienSelected== AM }" @click="onMeridienClick(AM)">{{ AM }}</div> <div class="b-clockpicker-btn" :class="{ active: meridienSelected== PM }" @click="onMeridienClick(PM)">{{ PM }}</div> </div> <vue-frontend-components-clockpicker-face :picker-size="faceSize" :min="minFaceValue" :max="maxFaceValue" :face-numbers="isSelectingHour ? hours : minutes" :disabled-values="faceDisabledValues" :double="isSelectingHour && isHourFormat24" :value="isSelectingHour ? hoursSelected : minutesSelected" @input="onClockInput" @change="onClockChange"/> </div> </div> <footer v-if="$slots.default !== undefined && $slots.default.length" class="b-clockpicker-footer card-footer"> <slot/> </footer> </div> </vue-frontend-components-dropdown> <input v-else ref="input" type="time" autocomplete="off" :value="formatHHMMSS(computedValue)" :placeholder="placeholder" :loading="loading" :max="formatHHMMSS(maxTime)" :min="formatHHMMSS(minTime)" :disabled="disabled" :readonly="false" v-bind="$attrs" :use-html5-validation="useHtml5Validation" style="-webkit-appearance: none" @click.stop="toggle(true)" @keyup.enter="toggle(true)" @change="onChangeNativePicker" @focus="handleOnFocus" @blur="onBlur() && checkHtml5Validity()"/> <span class="icon is-right is-clickable" v-if="dateSelected" @click="dateSelected = null"><i class="fai fa-circle-times"></i></span> </div> </div>'}),window.$app.defineComponent("frontend","vue-frontend-components-datapicker",{inheritAttrs:!1,props:{value:Date,dayNames:{type:Array,default:function(){return Vue.prototype.$getDaysNames()}},monthNames:{type:Array,default:function(){return Vue.prototype.$getMonthsNames()}},firstDayOfWeek:{type:Number,default:function(){return Vue.prototype.$getFirstDayWeek()}},inline:Boolean,minDate:Date,maxDate:Date,focusedDate:Date,placeholder:String,editable:Boolean,disabled:Boolean,unselectableDates:Array,unselectableDaysOfWeek:{type:Array,default:function(){return[]}},selectableDates:Array,dateFormatter:{type:Function,default:function(e){return date_format(window.i18n.formats.date,Date.parse(e)/1e3|0)}},dateParser:{type:Function,default:function(e){return new Date(Date.parse(e))}},dateCreator:{type:Function,default:function(){return new Date}},mobileNative:{type:Boolean,default:!0},position:String,events:Array,indicators:{type:String,default:"dots"},required:{type:Boolean,default:!1},expanded:Boolean,loading:Boolean,rounded:Boolean,autocomplete:String,maxlength:[Number,String],useHtml5Validation:{type:Boolean,default:!0}},data:function(){var e=this.value||this.focusedDate||this.dateCreator();return{dateSelected:this.value,focusedDateData:{month:e.getMonth(),year:e.getFullYear()},_elementRef:"input",_isDatepicker:!0,isValid:!0,isFocused:!1,newIconPack:"fa"}},computed:{listOfYears:function(){for(var e=this.maxDate?this.maxDate.getFullYear():Math.max(this.dateCreator().getFullYear(),this.focusedDateData.year)+3,t=[],i=this.minDate?this.minDate.getFullYear():1900;i<=e;i++)t.push(i);return t.reverse()},isFirstMonth:function(){return!!this.minDate&&new Date(this.focusedDateData.year,this.focusedDateData.month)<=new Date(this.minDate.getFullYear(),this.minDate.getMonth())},isLastMonth:function(){if(!this.maxDate)return!1;var e=new Date(this.focusedDateData.year,this.focusedDateData.month);return new Date(this.maxDate.getFullYear(),this.maxDate.getMonth())<=e},isMobile:function(){return this.mobileNative&&screen.width<768},parentField:function(){for(var e=this.$parent,t=0;t<3;t++)e&&!e.$data._isField&&(e=e.$parent);return e},statusType:function(){if(this.parentField&&this.parentField.newType){if("string"==typeof this.parentField.newType)return this.parentField.newType;for(var e in this.parentField.newType)if(this.parentField.newType[e])return e}},statusMessage:function(){if(this.parentField)return this.parentField.newMessage}},watch:{dateSelected:function(e){var t=e||this.dateCreator();this.focusedDateData={month:t.getMonth(),year:t.getFullYear()},this.$emit("input",e),this.$refs.dropdown&&(this.$refs.dropdown.isActive=!1)},value:function(e){this.dateSelected=e,this.isValid||null==this.$refs.input.checkHtml5Validity||this.$refs.input.checkHtml5Validity()},focusedDate:function(e){e&&(this.focusedDateData={month:e.getMonth(),year:e.getFullYear()})},"focusedDateData.month":function(e){this.$emit("change-month",e)},"focusedDateData.year":function(e){this.$emit("change-year",e)}},methods:{updateSelectedDate:function(e){this.dateSelected=e},onChange:function(e){var t=this.dateParser(e);t&&!isNaN(t)?this.dateSelected=t:(this.dateSelected=null,this.$refs.input.newValue=this.dateSelected)},formatValue:function(e){return e&&!isNaN(e)?this.dateFormatter(e):null},decrementMonth:function(){this.disabled||(0<this.focusedDateData.month?--this.focusedDateData.month:(this.focusedDateData.month=11,--this.focusedDateData.year))},incrementMonth:function(){this.disabled||(this.focusedDateData.month<11?this.focusedDateData.month+=1:(this.focusedDateData.month=0,this.focusedDateData.year+=1))},formatYYYYMMDD:function(e){var t=new Date(e);if(!e||isNaN(t))return"";var i=t.getFullYear(),s=t.getMonth()+1,n=t.getDate();return i+"-"+(s<10?"0":"")+s+"-"+(n<10?"0":"")+n},onChangeNativePicker:function(e){var t=e.target.value;this.dateSelected=t?new Date(t.replace(/-/g,"/")):null},focus:function(){var e=this;void 0!==this.$data._elementRef&&this.$nextTick(function(){return e.$el.querySelector(e.$data._elementRef).focus()})},onBlur:function(e){this.isFocused=!1,this.$emit("blur",e),this.checkHtml5Validity()},onFocus:function(e){this.isFocused=!0,this.$emit("focus",e)},checkHtml5Validity:function(){var e=this;if(this.useHtml5Validation&&void 0!==this.$refs[this.$data._elementRef]){var t=this.$el.querySelector(this.$data._elementRef),i=null,s=null,n=!0;return t.checkValidity()||(i="is-danger",s=t.validationMessage,n=!1),this.isValid=n,this.$nextTick(function(){e.parentField&&(e.parentField.type||(e.parentField.newType=i),e.parentField.message||(e.parentField.newMessage=s))}),this.isValid}}},template:'<div class="has-feedback datepicker-container"> <div class="datepicker" :class="{\'is-expanded\': expanded}"> <div class="control has-icons-right" :class="{\'is-inline-mode\': !isMobile || inline}"> <vue-frontend-components-dropdown v-if="!isMobile || inline" ref="dropdown" :position="position" :disabled="disabled" :inline="inline"> <input v-if="!inline" ref="input" :required="required" slot="trigger" type="text" autocomplete="off" :value="formatValue(dateSelected)" :placeholder="placeholder" :rounded="rounded" :loading="loading" :disabled="disabled" v-bind="$attrs" @change.native="onChange($event.target.value)" @focus="$emit(\'focus\', $event)" @blur="$emit(\'blur\', $event) && checkHtml5Validity()"/> <vue-frontend-components-dropdown-item :disabled="disabled" custom> <header class="datepicker-header"> <template v-if="$slots.header !== undefined && $slots.header.length"> <slot name="header"/> </template> <div v-else class="field has-addons"> <div class="control"> <a v-show="!isFirstMonth && !disabled" class="button" role="button" :disabled="disabled" @click.prevent="decrementMonth" @keydown.enter.prevent="decrementMonth" @keydown.space.prevent="decrementMonth"> <i class="fai fa-angle-left"></i> </a> </div> <div class="control is-expanded"> <span class="select is-fullwidth"> <select v-model="focusedDateData.month" :disabled="disabled"> <option v-for="(month, index) in monthNames" :value="index" :key="month"> {{ month }} </option> </select> </span> </div> <div class="control is-expanded"> <span class="select is-fullwidth"> <select v-model="focusedDateData.year" :disabled="disabled"> <option v-for="year in listOfYears" :value="year" :key="year"> {{ year }} </option> </select> </span> </div> <div class="control"> <a v-show="!isLastMonth && !disabled" class="button" role="button" :disabled="disabled" @click.prevent="incrementMonth" @keydown.enter.prevent="incrementMonth" @keydown.space.prevent="incrementMonth"> <i class="fai fa-angle-right"></i> </a> </div> </div> </header> <div class="datepicker-content"> <vue-frontend-components-datepicker-table v-model="dateSelected" :day-names="dayNames" :month-names="monthNames" :first-day-of-week="firstDayOfWeek" :min-date="minDate" :max-date="maxDate" :focused="focusedDateData" :disabled="disabled" :unselectable-dates="unselectableDates" :unselectable-days-of-week="unselectableDaysOfWeek" :selectable-dates="selectableDates" :events="events" :indicators="indicators" :date-creator="dateCreator" @close="$refs.dropdown.isActive = false"/> </div> <footer v-if="$slots.default !== undefined && $slots.default.length" class="datepicker-footer"> <slot/> </footer> </vue-frontend-components-dropdown-item> </vue-frontend-components-dropdown> <input v-else ref="input" type="date" :required="required" autocomplete="off" :value="formatYYYYMMDD(value)" :placeholder="placeholder" :loading="loading" :max="formatYYYYMMDD(maxDate)" :min="formatYYYYMMDD(minDate)" :disabled="disabled" v-bind="$attrs" @change="onChangeNativePicker" @focus="$emit(\'focus\', $event)" @blur="$emit(\'blur\', $event) && checkHtml5Validity()"/> <span class="icon is-right is-clickable" v-if="value" @click="value = null"><i class="fai fa-circle-times"></i></span> </div> </div> </div>'}),window.$app.defineComponent("frontend","vue-frontend-components-datepicker-table-row",{props:{selectedDate:Date,week:{type:Array,required:!0},month:{type:Number,required:!0},minDate:Date,maxDate:Date,disabled:Boolean,unselectableDates:Array,unselectableDaysOfWeek:Array,selectableDates:Array,events:Array,indicators:String,dateCreator:Function},methods:{selectableDate:function(e){var t=[];if(this.minDate&&t.push(e>=this.minDate),this.maxDate&&t.push(e<=this.maxDate),t.push(e.getMonth()===this.month),this.selectableDates)for(var i=0;i<this.selectableDates.length;i++){var s=this.selectableDates[i];if(e.getDate()===s.getDate()&&e.getFullYear()===s.getFullYear()&&e.getMonth()===s.getMonth())return!0;t.push(!1)}if(this.unselectableDates)for(var n=0;n<this.unselectableDates.length;n++){var a=this.unselectableDates[n];t.push(e.getDate()!==a.getDate()||e.getFullYear()!==a.getFullYear()||e.getMonth()!==a.getMonth())}if(this.unselectableDaysOfWeek)for(var o=0;o<this.unselectableDaysOfWeek.length;o++){var l=this.unselectableDaysOfWeek[o];t.push(e.getDay()!==l)}return t.indexOf(!1)<0},emitChosenDate:function(e){this.disabled||this.selectableDate(e)&&this.$emit("select",e)},eventsDateMatch:function(e){if(!this.events.length)return!1;for(var t=[],i=0;i<this.events.length;i++)this.events[i].date.getDay()===e.getDay()&&t.push(this.events[i]);return!!t.length&&t},classObject:function(e){function t(e,t){return!(!e||!t)&&(e.getDate()===t.getDate()&&e.getFullYear()===t.getFullYear()&&e.getMonth()===t.getMonth())}return{"is-selected":t(e,this.selectedDate),"is-today":t(e,this.dateCreator()),"is-selectable":this.selectableDate(e)&&!this.disabled,"is-unselectable":!this.selectableDate(e)||this.disabled}}},template:'<div class="datepicker-row"> <template v-for="(day, index) in week"> <a v-if="selectableDate(day) && !disabled" :key="index" :class="[classObject(day), {\'has-event\':eventsDateMatch(day)}, indicators]" class="datepicker-cell" role="button" href="#" :disabled="disabled" @click.prevent="emitChosenDate(day)" @keydown.enter.prevent="emitChosenDate(day)" @keydown.space.prevent="emitChosenDate(day)"> {{ day.getDate() }} <div class="events" v-if="eventsDateMatch(day)"> <div class="event" :class="event.type" v-for="(event, index) in eventsDateMatch(day)" :key="index"/> </div> </a> <div v-else :key="index" :class="classObject(day)" class="datepicker-cell"> {{ day.getDate() }} </div> </template> </div>'}),window.$app.defineComponent("frontend","vue-frontend-components-datepicker-table",{props:{value:Date,dayNames:Array,monthNames:Array,firstDayOfWeek:Number,events:Array,indicators:String,minDate:Date,maxDate:Date,focused:Object,disabled:Boolean,dateCreator:Function,unselectableDates:Array,unselectableDaysOfWeek:Array,selectableDates:Array},computed:{visibleDayNames:function(){for(var e=[],t=this.firstDayOfWeek;e.length<this.dayNames.length;){var i=this.dayNames[t%this.dayNames.length];e.push(i),t++}return e},hasEvents:function(){return this.events&&this.events.length},eventsInThisMonth:function(){if(!this.events)return[];for(var e=[],t=0;t<this.events.length;t++){var i=this.events[t];i.hasOwnProperty("date")||(i={date:i}),i.hasOwnProperty("type")||(i.type="is-primary"),i.date.getMonth()===this.focused.month&&i.date.getFullYear()===this.focused.year&&e.push(i)}return e}},methods:{updateSelectedDate:function(e){this.$emit("input",e)},weekBuilder:function(e,t,i){for(var s=new Date(i,t),n=[],a=new Date(i,t,e).getDay(),o=a>=this.firstDayOfWeek?a-this.firstDayOfWeek:7-this.firstDayOfWeek+a,l=1,r=0;r<o;r++)n.unshift(new Date(s.getFullYear(),s.getMonth(),e-l)),l++;n.push(new Date(i,t,e));for(var c=1;n.length<7;)n.push(new Date(i,t,e+c)),c++;return n},weeksInThisMonth:function(t,e){for(var i=[],s=new Date(e,t+1,0).getDate(),n=1;n<=s+6;){var a=this.weekBuilder(n,t,e),o=!1;a.forEach(function(e){e.getMonth()===t&&(o=!0)}),o&&i.push(a),n+=7}return i},eventsInThisWeek:function(e,t){if(!this.eventsInThisMonth.length)return[];for(var i=[],s=[],s=this.weeksInThisMonth(this.focused.month,this.focused.year),n=0;n<s[t].length;n++)for(var a=0;a<this.eventsInThisMonth.length;a++){this.eventsInThisMonth[a].date.getTime()===s[t][n].getTime()&&i.push(this.eventsInThisMonth[a])}return i}},template:'<section class="datepicker-table"> <header class="datepicker-header"> <div v-for="(day, index) in visibleDayNames" :key="index" class="datepicker-cell"> {{ day }} </div> </header> <div class="datepicker-body" :class="{\'has-events\':hasEvents}"> <vue-frontend-components-datepicker-table-row v-for="(week, index) in weeksInThisMonth(focused.month, focused.year)" :key="index" :selected-date="value" :week="week" :month="focused.month" :min-date="minDate" :max-date="maxDate" :disabled="disabled" :unselectable-dates="unselectableDates" :unselectable-days-of-week="unselectableDaysOfWeek" :selectable-dates="selectableDates" :events="eventsInThisWeek(week, index)" :indicators="indicators" :date-creator="dateCreator" @select="updateSelectedDate"/> </div> </section>'}),window.$app.defineComponent("frontend","vue-frontend-components-document",{props:["value"],template:'<div class="document"> <div v-for="b in value.blocks" class="ce-block" :class="\'is-\'+b.type"> <p v-if="b.type == \'paragraph\'" class="ce-paragraph" v-html="b.data.text"/> <component v-if="b.type == \'header\'" v-bind:is="\'h\'+b.data.level" v-html="b.data.text" class="ce-header"/> <div v-if="b.type == \'image\'" :class="{\'has-bordered\': b.data.withBorder, \'has-stretched\': b.data.stretched, \'has-background\': b.data.withBackground}"> <div class="doc-image" :data-size="(b.data.files != undefined)?b.data.files.length:1"> <img v-if="b.data.file != undefined" :src="b.data.file.url" :alt="b.data.caption" @click="showLightboxPicture(b.data.file.url)"> <img v-for="p in b.data.files" :src="p.url" :alt="b.data.caption" @click="showLightboxPicture(p.url)"> </div> </div> <component v-if="b.type == \'list\'" v-bind:is="(b.data.style == \'ordered\')?\'ol\':\'ul\'"><li v-for="item in b.data.items" v-html="item"/></component> <div v-if="b.type == \'embed\'"> <div v-if="[\'vimeo\', \'youtube\'].indexOf(b.data.service) != -1" class="video-container"> <iframe :src="b.data.embed" frameborder="0" allowtransparency="true" webkitallowfullscreen mozallowfullscreen allowfullscreen></iframe> </div> </div> <div v-if="b.type == \'alert\'" :class="\'cdx-alert cdx-alert-\'+b.data.type" v-html="b.data.message"></div> <div v-if="b.type == \'delimiter\'" class="ce-delimiter"></div> <pre v-if="b.type == \'code\'" class="highlightjs" :class="\'lang-\'+b.data.language">{{b.data.code}}</pre> <blockquote v-if="b.type == \'quote\'" v-html="b.data.text"></blockquote> <table class="doc-table" v-if="b.type == \'table\'"> <tbody> <tr v-for="tr in b.data.content"><td v-for="td in tr" v-html="td"></td></tr> </tbody> </table> <vue-frontend-blocks-video v-if="b.type == \'video\'" :options=\'{"url": b.data.url, "type": b.data.type, "handler": "player", "is_autoplay": false, "is_autohide": false, "poster": null}\'/> </div> </div>'}),window.$app.defineComponent("frontend","vue-frontend-components-dropdown-item",{props:{value:{type:[String,Number,Boolean,Object,Array,Function],default:null},separator:Boolean,disabled:Boolean,custom:Boolean,paddingless:Boolean,hasLink:Boolean,ariaRole:{type:String,default:""}},computed:{anchorClasses:function(){return{"is-disabled":this.$parent.disabled||this.disabled,"is-paddingless":this.paddingless,"is-active":null!==this.value&&this.value===this.$parent.selected}},itemClasses:function(){return{"dropdown-item":!this.hasLink,"is-disabled":this.disabled,"is-paddingless":this.paddingless,"is-active":null!==this.value&&this.value===this.$parent.selected,"has-link":this.hasLink}},ariaRoleItem:function(){return"menuitem"===this.ariaRole||"listitem"===this.ariaRole?this.ariaRole:null},isClickable:function(){return!(this.$parent.disabled||this.separator||this.disabled||this.custom)}},methods:{selectItem:function(){this.isClickable&&(this.$parent.selectItem(this.value),this.$emit("click"))}},created:function(){if(!this.$parent.$data._isDropdown)throw this.$destroy(),new Error("You should wrap bDropdownItem on a bDropdown")},template:'<hr v-if="separator" class="dropdown-divider"> <a v-else-if="!custom && !hasLink" class="dropdown-item" :class="anchorClasses" @click="selectItem" :role="ariaRoleItem"> <slot/> </a> <div v-else :class="itemClasses" @click="selectItem" :role="ariaRoleItem"> <slot/> </div>'}),window.$app.defineComponent("frontend","vue-frontend-components-dropdown",{props:{value:{type:[String,Number,Boolean,Object,Array,Function],default:null},disabled:Boolean,hoverable:Boolean,inline:Boolean,position:{type:String,validator:function(e){return-1<["is-top-right","is-top-left","is-bottom-left"].indexOf(e)}},mobileModal:{type:Boolean,default:!0},ariaRole:{type:String,default:""},animation:{type:String,default:"fade"}},data:function(){return{selected:this.value,isActive:!1,_isDropdown:!0}},computed:{rootClasses:function(){return[this.position,{"is-disabled":this.disabled,"is-hoverable":this.hoverable,"is-inline":this.inline,"is-active":this.isActive||this.inline,"is-mobile-modal":this.isMobileModal}]},isMobileModal:function(){return this.mobileModal&&!this.inline&&!this.hoverable},ariaRoleMenu:function(){return"menu"===this.ariaRole||"list"===this.ariaRole?this.ariaRole:null}},watch:{value:function(e){this.selected=e},isActive:function(e){this.$emit("active-change",e)}},methods:{selectItem:function(e){this.selected!==e&&(this.$emit("change",e),this.selected=e),this.$emit("input",e),this.isActive=!1},isInWhiteList:function(e){if(e===this.$refs.dropdownMenu)return!0;if(e===this.$refs.trigger)return!0;if(void 0!==this.$refs.dropdownMenu){var t=this.$refs.dropdownMenu.querySelectorAll("*"),i=!0,s=!1,n=void 0;try{for(var a,o=t[Symbol.iterator]();!(i=(a=o.next()).done);i=!0){if(e===a.value)return!0}}catch(e){s=!0,n=e}finally{try{!i&&o.return&&o.return()}finally{if(s)throw n}}}if(void 0!==this.$refs.trigger){var l=this.$refs.trigger.querySelectorAll("*"),r=!0,c=!1,d=void 0;try{for(var u,h=l[Symbol.iterator]();!(r=(u=h.next()).done);r=!0){if(e===u.value)return!0}}catch(e){c=!0,d=e}finally{try{!r&&h.return&&h.return()}finally{if(c)throw d}}}return!1},clickedOutside:function(e){this.inline||this.isInWhiteList(e.target)||(this.isActive=!1)},toggle:function(){var e=this;this.disabled||this.hoverable||(this.isActive?this.isActive=!this.isActive:this.$nextTick(function(){e.isActive=!e.isActive}))}},created:function(){"undefined"!=typeof window&&document.addEventListener("click",this.clickedOutside)},beforeDestroy:function(){"undefined"!=typeof window&&document.removeEventListener("click",this.clickedOutside)},template:'<div class="dropdown" :class="rootClasses"> <div v-if="!inline" role="button" ref="trigger" class="dropdown-trigger" @click="toggle" aria-haspopup="true"> <slot name="trigger"/> </div> <transition :name="animation"> <div v-if="isMobileModal" v-show="isActive" class="background" :aria-hidden="!isActive"/> </transition> <transition :name="animation"> <div v-show="(!disabled && (isActive || hoverable)) || inline" ref="dropdownMenu" class="dropdown-menu" :aria-hidden="!isActive"> <div class="dropdown-content" :role="ariaRoleMenu"> <slot/> </div> </div> </transition> </div>'}),window.$app.defineComponent("frontend","vue-frontend-form-agreement-modal",{data:function(){return{isOpened:!1,isLoadingAgreement:!0,agreement:null}},props:{isOpened:Boolean,message:String},methods:{open:function(e,t){var i=this;this.isOpened=!0,this.agreement||(t=t?JSON.parse(t):{},this.$api.get(e,{params:Object.assign(t,{request:"body"})}).then(function(e){i.agreement=e.response.body,i.isLoadingAgreement=!1}))}},template:'<mx-modal :active.sync="isOpened" :has-modal-card="true"> <div class="modal-card has-text-black" style="font-size: 1rem"> <header class="modal-card-head"><p class="modal-card-title">{{\'Юридическая информация\'|gettext}}</p> <button type="button" class="modal-close is-large" @click="isOpened = false"></button></header> <section class="modal-card-body"> <div class="border col-xs-12" v-if="isLoadingAgreement"><div class="loading-overlay loading-block is-active"><div class="loading-icon"></div></div></div> <div v-html="agreement"></div> </section> <div class="modal-card-foot"> <button type="button" class="button is-dark" @click="isOpened = false">{{\'Закрыть\'|gettext}}</button> </div> </div> </mx-modal>'}),window.$app.defineComponent("frontend","vue-frontend-form-complete-modal",{props:{isOpened:Boolean,message:String},watch:{isOpened:function(){this.$emit("update:isOpened",this.isOpened)}},template:'<mx-modal :active.sync="isOpened" :has-modal-card="true"> <div class="modal-card modal-card-little"> <section class="modal-card-body has-text-black"> <div class="has-text-centered"> <div class="has-mb-2"> <div class="sa-icon sa-success animate" style="display: block;"> <span class="sa-line sa-tip animateSuccessTip"></span> <span class="sa-line sa-long animateSuccessLong"></span> <div class="sa-placeholder"></div> <div class="sa-fix"></div> </div> </div> <h4 v-html="$nl2br($escape(message))"></h4> </div> </section> <div class="modal-card-foot" style="justify-content: center"> <button type="button" class="button is-dark" @click="isOpened = false">{{\'Закрыть\'|gettext}}</button> </div> </div> </mx-modal>'}),window.$app.defineComponent("frontend","vue-frontend-form-elements",{props:{options:Object,fields:Array,errors:Object,isLoading:Boolean,checkDepends:Boolean,block_id:String,mode:{default:"view"}},data:function(){return{focused:null}},mounted:function(){this.rebuildValues()},watch:{fields:function(){this.rebuildValues()}},computed:{disabled:function(){return null!=this.$account.readonly&&this.$account.readonly||this.isLoading}},methods:{rebuildValues:function(){var e=this;_.each(this.fields,function(i){switch(i.typename){case"checkbox":i.default&&(i.value=1);break;case"country":$mx.lazy("countries."+i18n.locale+".js",function(){i.typename="select",i.variants=_.sortBy(_.filter(_.map(i18n.counties,function(e,t){return null!=i.ids&&i.ids.length&&-1==i.ids.indexOf(parseInt(t))?null:_.isObject(e)?e:{k:t,v:e}})),"v"),i.nulltitle=e.$gettext("-- Выберите страну --")});break;case"select":i.variants=_.map(i.variants,function(e,t){return _.isObject(e)?e:{k:t,v:e}})}})},stylesheet:function(){return this.options&&this.options.design&&this.options.design.on?"background:"+this.options.design.bg+";border-color:"+this.options.design.bg+";color:"+this.options.design.text:""},checkFieldDepends:function(e){return null==e.depends_name||(!this.checkDepends||(this.checkDepends(e)||null!=this.fields[e.depends_name]&&-1!=e.depends_value.indexOf(this.fields[e.depends_name].value)))},input_type:function(e){var t="text";return-1!=["password","number","email"].indexOf(e.typename)&&(t=e.typename),t},prepareParagraph:function(e){return e.text},clickParagraph:function(e){if(e.target&&"A"==e.target.tagName.toUpperCase()&&"view"==this.mode){var t=e.target;if("_blank"==t.getAttribute("target"))return;this.$refs.agreement.open(t.getAttribute("data-endpoint"),t.getAttribute("data-endpoint-params"))}e.preventDefault()},getFields:function(){var e=!0,t=[];for(i in this.fields){var s=this.fields[i];if(this.checkFieldDepends(s)&&-1==["paragraph","button"].indexOf(s.typename)){switch(s.typename){case"date":s.value=s.value?date_format("d.m.Y",s.value/1e3|0):"";break;case"time":s.value=s.value?date_format("H:i",s.value/1e3|0):"";break;default:switch(null==s.value&&(s.value=""),_typeof(s.value)){case"number":case"boolean":break;default:s.value=s.value.toString().trim()}}if(s.required&&!s.value){alert(this.$gettext("Необходимо заполнить поле")),e=!1;break}if("phone"==s.typename&&!s.valid&&s.value||!s.value&&s.required){alert(this.$gettext("Введите корректный номер телефона")),e=!1;break}if("email"==s.typename&&!s.valid&&s.value||!s.value&&s.required){if(!/^(([^а-я<>()[\]\\.,;:\s@\"]+(\.[^а-я<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(s.value)){alert(this.$gettext("Введите корректный email")),e=!1;break}}t[i]={type:s.type_id,value:s.value,idx:null==s.idx?null:s.idx}}}return e?t:null}},template:'<div class="has-rtl"> <div v-for="(field, idx) in fields" v-if="checkFieldDepends(field)"> <div v-if="field.typename == \'button\'" class="form-field"><button :type="(mode == \'view\')?\'submit\':\'button\'" class="button btn-link btn-link-title" :style="stylesheet(field)" :class="{\'is-loading\': isLoading}">{{field.title}}</button></div> <div v-else-if="field.typename == \'paragraph\'" class="form-field form-field-paragraph" style="font-size:1.1rem !important" v-html="prepareParagraph(field)" @click="clickParagraph"></div> <div v-else class="form-field" :class="{\'is-focused\': focused== idx, \'is-empty\': !field.value, \'has-error\': errors && errors[idx], \'has-compacted-mode\': [\'name\', \'text\', \'email\', \'number\', \'password\', \'select\', \'country\', \'date\', \'time\', \'textarea\', \'phone\'].indexOf(field.typename) != -1}" :data-type="field.typename"> <div v-if="field.typename == \'checkbox\'" class="checkbox-list"> <label class="checkbox"> <input type="checkbox" :checked="field.default" v-model="field.value" :required="field.required == 1" :disabled="disabled"> {{field.title}}<sup class="required" v-if="field.required">*</sup> </label> <div class="form-field-desc" v-if="field.text">{{field.text}}</div> </div> <label v-else class="label" :class="{\'is-marginless\': field.typename == \'radio\'}" :for="block_id+\'fid\'+idx">{{field.title}}<sup class="required" v-if="field.required == 1">*</sup></label> <div v-if="(field.typename != \'checkbox\') && field.text" class="form-field-desc">{{field.text}}</div> <input v-if="[\'name\', \'text\', \'email\', \'number\', \'password\'].indexOf(field.typename) != -1" :name="field.typename" :type="input_type(field)" :disabled="disabled" v-model="field.value" :required="field.required == 1" :id="block_id+\'fid\'+idx" @focus="focused = idx" @blur="focused = null"> <mx-phone v-if="field.typename == \'phone\'" :name="field.typename" v-model="field.value" :disabled="disabled" :required="field.required == 1" :isValid.sync="field.valid" :id="block_id+\'fid\'+idx" :title="\'Страна\'|gettext" @focus="focused = idx" @blur="focused = null"/> <textarea v-if="field.typename == \'textarea\'" rows="4" :disabled="disabled" v-model="field.value" :required="field.required == 1" :id="block_id+\'fid\'+idx" class="autoresize-init" @focus="focused = idx" @blur="focused = null"></textarea> <div class="select" v-if="field.typename == \'select\'"><select v-model="field.value" :required="field.required == 1" :disabled="disabled || field.disabled" @focus="focused = idx" @blur="focused = null"> <option :value="null" v-if="field.nulltitle">{{field.nulltitle}}</option> <option :value="null" v-else>{{\'-- Не выбрано --\'|gettext}}</option> <option v-for="v in field.variants" :value="v.k">{{v.v}}</option> </select></div> <div class="select" v-if="field.typename == \'country\'"><select disabled><option v-if="field.nulltitle">{{field.nulltitle}}</option><option v-else>{{\'-- Не выбрано --\'|gettext}}</option></select></div> <vue-frontend-components-datapicker v-if="(field.typename == \'date\') && (mode != \'edit\')" v-model=\'field.value\' :required="field.required == 1" :disabled="disabled || field.disabled" :id="block_id+\'fid\'+idx" @focus="focused = idx" @blur="focused = null"/> <vue-frontend-components-clockpicker v-if="(field.typename == \'time\') && (mode != \'edit\')" v-model="field.value" :disabled="disabled || field.disabled" hour-format="24" :id="block_id+\'fid\'+idx" @focus="focused = idx" @blur="focused = null"/> <input v-if="(mode == \'edit\') && ([\'date\', \'time\'].indexOf(field.typename) != -1)" type="text"> <div class="radio-list" v-if="field.typename == \'radio\'"> <label v-for="v in field.variants" class="radio"> <input type="radio" :value="v" :disabled="disabled" v-model="field.value" :required="field.required == 1" :name="\'b{1}f{2}\'|format(block_id, idx)"> {{v}} </label> </div> <p class="help is-danger" v-if="errors && errors[idx]">{{errors[idx]}}</p> </div> </div> <vue-frontend-form-agreement-modal ref="agreement" v-if="mode != \'edit\'"/> </div>'}),window.$app.defineComponent("frontend","vue-frontend-index",{data:function(){return{inited:!1}},methods:{reduildStyles:function(){StylesFactory.updateCSSBlock(this.$account.styles,this.$refs.styles)}},mounted:function(){this.reduildStyles(),this.inited=!0},template:'<div class="is-flex-fullheight theme-main" :class="StylesFactory.getPageClasses($account.theme, $account)"> <div ref=\'styles\'></div> <div v-for="a in $account.theme.extended.items" v-html="a.html"></div> <router-view v-if="inited"/> <vue-frontend-actionbar/> <component v-bind:is="\'vue-frontend-addons-\'+w.name" v-for="w in $account.widgets" v-model="w.data"/> <vue-frontend-blocks-html v-if="$account.html" :options=\'$account\'/> </div>'}),window.$app.defineComponent("frontend","vue-frontend-loading-blocks",{data:function(){return{products:[0,1,2,3,4]}},props:["blocks"],computed:{avatarLink:function(){return"/"+this.$account.nickname+(2==this.$account.products_avatar?"/m/":"")},avatarClassname:function(){return"profile-avatar profile-avatar-"+this.$account.avatar_size}},template:'<div> <div class="block-item" v-for="name in blocks"> <div class="block-item block-avatar" v-if="name == \'avatar\'"> <div class="has-text-centered"><div :class="avatarClassname" class="is-fetching-block"></div></div> <div class="has-text-centered text-avatar" v-if="!$account.is_avatar_hide_text"><p class="is-fetching-block">@{{$account.nickname}}</p></div> </div> <div class="block-item" v-if="name == \'picture\'"> <div class="block-slider-inner"> <div class="slider slider-pictures"> <div class="slider-inner"> <div class="slider-slide"><div class="picture-container picture-cover is-fetching-block" style="padding-top: 100%"><div></div></div></div> </div> </div> </div> </div> <div class="block-item" v-if="name == \'title\'"> <h3><p class="is-fetching-block">Product title</p></h3> </div> <div class="block-item" v-if="name == \'link\'"> <div class="button btn-link active block-link is-fetching-block">Link</div> </div> <div class="row row-small" v-if="name == \'products\'"> <div class="col-xs-6 col-sm-4 item" v-for="p in products"> <div class="product-container-outer"> <div class="product-container is-fetching-block"> </div> <div class="product-container-text"> <i style="width: 50%"><p class="is-fetching-block" style="display: block">Title</p></i> <b style="width: 30%"><p class="is-fetching-block" style="display: block">0.00</p></b> </div> </div> </div> </div> </div> </div>'}),window.$app.defineComponent("frontend","vue-frontend-market-discount",{props:["hasPromocodes","discountValue","discounts"],computed:{promocode:function(){var e=null;for(i in this.discounts){var t=this.discounts[i];if(t.promocode){e=t.promocode;break}}return e}},template:'<transition name="fade"> <div class="row row-small" v-if="hasPromocodes || discountValue"> <div class="col-sm-1 col-xs-3" style="line-height: 0"><div class="product-container-outer slider-has-border"><div class="product-container fa fai fa-badge-percent"></div></div></div> <div class="col-sm-11 col-xs-9"> <div class="row row-small"> <div class="col-sm col-xs"> <span v-if="discountValue && !promocode">{{\'Скидка\'|gettext}}</span> <span v-else>{{\'Промокод\'|gettext}}</span> <div style="font-size: 70%;color: #777" v-if="hasPromocodes"> <div class="tags has-addons" v-if="promocode"><span class="tag">{{promocode}}</span><a role="button"tabindex="0" class="tag is-delete" @click="$emit(\'clearPromocode\')"></a></div> <a v-else style="text-decoration: underline;opacity: .7" @click="$emit(\'openPromocodeForm\')">{{\'Активировать промокод\'|gettext}}</a> </div> </div> <div class="col-sm-3 col-xs col-shrink has-text-nowrap has-text-right"> <transition name="fade"> <span v-if="discountValue">-&nbsp;{{discountValue|currency}}</span> </transition> </div> </div> </div> </div> </transition>'}),window.$app.defineComponent("frontend","vue-frontend-page-blocks",{props:{fields:Object,data:Object,page_id:Number,part:String,isEmbeded:Boolean,showBlockedMessage:Boolean,excludeTypes:{default:[]}},data:function(){return{prefix:""}},mounted:function(){this.prepareStyles()},watch:{showBlockedMessage:function(e){this.$emit("update:showBlockedMessage",e)},fields:function(){this.prepareStyles()}},computed:{mode:function(){return-1==document.location.pathname.indexOf("template:")?"view":"edit"}},methods:{classSection:function(e,t){var i=this.fields;return[null==e.section||null==e.section.bg||null==e.section.bg.color1?null:"is-"+lightOrDark(e.section.bg.color1),e.section?"has-s s-"+this.prefix+t+(null==e.section.bg||null==e.section.bg.color1?" is-transparent":""):null,null!=e.section&&null!=e.section.indent&&e.section.indent.on?" has-indent":null,i[t+1]&&i[t+1].section?" has-next-s"+(null==i[t+1].section.bg||null==i[t+1].section.bg.color1?" is-next-transparent":""):null,{" is-empty":!e.items.length}]},checkTariff:function(e){this.$auth.isAllowTariff(e)||(this.showBlockedMessage=!0)},prepareStyles:function(){var s=this;this.prefix=this.page_id?this.page_id+"-":"";var n={},a=StylesFactory.getDefaultSection(this.$account.theme,!1);_.each(this.fields,function(e,t){var i;e.section&&(e.section&&e.section.bg&&e.section.bg.picture&&(e.section.bg.picture.link="//"+Vue.prototype.$account.storage_domain+"/p/"+e.section.bg.picture.filename),((i=_.merge(e.section.id&&null!=s.$account.theme.sections&&null!=s.$account.theme.sections[e.section.id]?_.merge(a,s.$account.theme.sections[e.section.id],!0):a,e.section,!0)).bg.type&&i.bg.type!=s.$account.theme.bg.type||i.bg.color1)&&(i.bg=_.merge({type:"solid",color1:s.$account.theme.bg.color1,color2:s.$account.theme.bg.color2},i.bg,!0)),StylesFactory.prepareSectionStyles(i,s.prefix+t,s.$account.theme,n,void 0,"page",s.isEmbeded),e.section=i),_.each(e.items,function(e){null!=e.options&&StylesFactory.prepareStyles(e.block_id,e.block_type_name,e.options,n)})}),StylesFactory.updateCSSBlock(n,this.$refs.styles)},loadEntry:function(e){return e="vue-frontend-blocks-"+e,window.$app.loadComponent(e),e}},template:'<div> <div ref=\'styles\'></div> <div> <div class="blocks-section is-empty"><div><div class="page-container"></div></div></div> <div v-for="(p, j) in fields" class="blocks-section" :class="classSection(p, j)"> <div> <div :class="{\'page-container\': !isEmbeded}"> <div class="section-main" v-if="p.items.length"> <div> <div> <div class="block-item" v-for="(f, i) in p.items" v-if="excludeTypes.indexOf(f.block_type_name) == -1" :key="i" :class="[\'block-\'+f.block_type_name, {\'is-textable\': f.block_type_name == \'text\', \'is-headline\': (f.block_type_name == \'text\') && (f.options != undefined) && (f.options.text_size != undefined) && f.options.text_size[0] == \'h\', \'block-item-locked\': !$auth.isAllowTariff(f.tariff)}]" :style="{transform: (f.block_type_name == \'pictures\')?\'translate(0, 0)\':\'\'}" @click="checkTariff(f.tariff)"> <div :class="\'b-\'+f.block_id"> <component v-bind:is="loadEntry(f.block_type_name)" :options="f.options" :data="data" :section="p.section" :block_id="f.block_id" :block="f" :account="$account" :theme="$account.theme" :index="i" :page_id="page_id" :part="part" @refreshPage="$parent.fetchData" :isEmbeded="isEmbeded" :mode="mode"/> </div> </div> <vue-frontend-brandlink v-if="!isEmbeded && j== fields.length - 1 && p.section != null && (fields[fields.length-1].section.indent == undefined || !fields[fields.length-1].section.indent.on)"></vue-frontend-brandlink> </div> </div> </div> </div> </div> </div> </div> </div>'}),window.$app.defineComponent("frontend","vue-frontend-page",{data:function(){return{showBlockedMessage:!1,fields:[],options:{},data:null,isFetching:!1}},props:["page_id","part"],created:function(){this.$api.cacheKeyFunc=function(e,t){return e+"?"+$mx.param(t)},window.data?(this.fields=this.checkFields(window.data.fields),this.options=window.data.options,this.data=window.data.data||null,delete window.data,$events.fire("pageview",{page_id:this.current_page_id,profile_id:this.$account.profile_id}),$events.fire("contentupdated")):this.fetchData()},watch:{page_id:function(){this.fetchData()},part:function(){this.fetchData()}},computed:{current_page_id:function(){return this.page_id?parseInt(this.page_id,16):this.$account.current_page_id},foundBlocked:function(){for(var e=0;e<this.fields.length;e++)for(var t=0;t<this.fields[e].items.length;t++)if(!this.$auth.isAllowTariff(this.fields[e].items[t].tariff))return!0;return!1},pageClasses:function(){var e=[];return this.options&&(null!=this.options.max_width&&e.push("max-page-container-"+this.options.max_width),null!=this.options.valign&&e.push("page-valign-"+this.options.valign)),e}},methods:{fetchData:_.debounce(function(){var t=this,e=this.$history.prev,i=this.$router.currentRoute,s=null==e||("part"==i.name||"part.index"==i.name)&&("part"==e.name||"part.index"==e.name)&&e.params.part==i.params.part&&"m"==e.params.part,n=setTimeout(function(){s||(t.isFetching=!0)},350);s||(this.fields=[],this.isFetching=!0),this.$api.get("page/get",{params:{part:this.part,page_id:this.page_id?parseInt(this.page_id,16):null}}).then(function(e){clearTimeout(n),null!=e.redirect?t.$router.replace(e.redirect):(t.fields=t.checkFields(e.response.fields),t.options=e.response.options,t.data=e.response.data||null,window.hasAvatar=!1,_.each(t.fields,function(e){_.each(e.items,function(e){window.hasAvatar|="avatar"==e.block_type_name})}),$events.fire("pageview",{page_id:t.$account.current_page_id=e.response.page_id,profile_id:t.$account.profile_id}),$events.fire("contentupdated"),window.$scrollPosition&&t.$nextTick(function(){window.scrollTo(window.$scrollPosition.x,window.$scrollPosition.y)})),t.isFetching=!1})},1),checkFields:function(e){return _.each(e,function(e){_.each(e.items,function(e){e.tariff="basic"})}),e}},template:'<div class="is-flex-fullheight" :class="pageClasses"> <a class="header-banner lock-footer has-background-black" v-if="!$account.has_nickname && $account.allow_by_session && !$account.allow_by_token" style="position: inherit" target="_blank" :href="\'https://\'+this.$account.domain+\'/profile/pages/#publish\'"> <div class="container has-mb-2 has-mt-2 is-text-centered" style="justify-content: center">{{\'Страница недоступна для просмотра всем. Для решения этой проблемы вам необходимо подключить профиль или доменное имя\'|gettext}}</div> </a> <div class="is-flex-fullheight"> <div class="page-container block-item has-pb-1 has-pt-3" style="max-width: 1080px" v-if="isFetching"> <vue-frontend-loading-blocks :blocks="[\'avatar\', \'link\', \'link\', \'link\']"/> </div> <div class="is-flex-fullheight" v-else> <div class="container has-mt-3" v-if="$account.lock_message"> <div class="message is-danger block-text has-text-centered"><div class="message-body">{{$account.lock_message}}</div></div> </div> <main class="is-flex-fullheight"> <vue-frontend-page-blocks :fields="fields" :data="data" :page_id="current_page_id" :part="part" :showBlockedMessage.sync="showBlockedMessage"/> <vue-frontend-brandlink v-if="!fields.length || fields[fields.length-1].section == null || (fields[fields.length-1].section.indent != undefined && fields[fields.length-1].section.indent.on)"/> </main> </div> </div> <div class="footer-banner lock-footer has-background-black has-close" :class="{\'is-closed\': !showBlockedMessage}" @click="showBlockedMessage = false" v-if="foundBlocked"> <div class="container has-mb-2 has-mt-2">{{\'К сожалению эта функция была заблокирована, так как владелец страницы своевременно не оплатил ее. Если вас не затруднит, сообщите владельцу страницы о данной проблеме\'|gettext}}</div> </div> </div>'}),window.$app.defineComponent("frontend","vue-frontend-vbar",{data:function(){return{dragging:{enable:!1,axis:"",offset:""},bars:{horizontal:{elm:"",parent:"",size:0},vertical:{elm:"",parent:"",size:0}},wrapperObj:{elm:"",scrollHeight:"",scrollWidth:"",scrollLeft:"",scrollTop:""},container:{elm:"",scrollHeight:"",scrollWidth:""}}},mounted:function(){addResizeListener(this.$refs.container,this.resize),addResizeListener(this.$refs.wrapperRef.children[0],this.resize),document.addEventListener("mousemove",this.onDrag),document.addEventListener("touchmove",this.onDrag),document.addEventListener("mouseup",this.stopDrag),document.addEventListener("touchend",this.stopDrag),this.getSizes()},beforeDestroy:function(){removeResizeListener(this.$refs.container,this.resize),removeResizeListener(this.$refs.wrapperRef.children[0],this.resize),document.removeEventListener("mousemove",this.onDrag),document.removeEventListener("touchmove",this.onDrag),document.removeEventListener("mouseup",this.stopDrag),document.removeEventListener("touchend",this.stopDrag)},computed:{propWrapperSize:function(){return this.wrapper?this.wrapper:""},propBarVertical:function(){return this.vBar?this.vBar:""},propBarInternalVertical:function(){return this.vBarInternal?this.vBarInternal:""},propBarHorizontal:function(){return this.hBar?this.hBar:""},propBarInternalHorizontal:function(){return this.hBarInternal?this.hBarInternal:""},barSizeVertical:function(){if(this.bars.horizontal.size&&this.bars.vertical.size)return{height:"calc(100% - 16px)"}},barSizeHorizontal:function(){if(this.bars.horizontal.size&&this.bars.vertical.size)return{width:"calc(100% - 16px)"}},barInternalVertical:function(){var e=this.getBarInternal("Y");return{height:this.bars.vertical.size+"px",top:e+"px"}},barInternalHorizontal:function(){var e=this.getBarInternal("X");return{width:this.bars.horizontal.size+"px",left:e+"px"}},validationScrolls:function(){return this.bars.horizontal.size?this.bars.vertical.size?void 0:"overflowY: hidden":"overflowX: hidden"},width:function(){return this.$refs.wrapperRef.getBoundingClientRect().width},shadowStyle:function(){return"-webkit-mask-image: linear-gradient(90deg, transparent 0%, rgba(0, 0, 0, 1.0) "+Math.min(this.wrapperObj.scrollLeft/80*10,10)+"%, rgba(0, 0, 0, 1.0) "+(100-Math.min((this.wrapperObj.scrollWidth-this.wrapperObj.scrollLeft-this.container.scrollWidth)/80*10,10))+"%, transparent 100%);"}},methods:{scroll:function(){this.getSizes(0,0)},resize:function(){this.getSizes()},getBarInternal:function(e){var t=void 0,i=void 0,s=void 0,n=void 0,a=void 0,a=this.bars.horizontal.size&&this.bars.vertical.size?40:0;return"X"===e?(t=this.wrapperObj.scrollLeft,i=this.wrapperObj.scrollWidth,s=this.bars.horizontal.size+a,n=this.container.scrollWidth):"Y"===e&&(t=this.wrapperObj.scrollTop,i=this.wrapperObj.scrollHeight,s=this.bars.vertical.size+a,n=this.container.scrollHeight),t/(i-n)*(n-s)},getCoordinates:function(e,t){var i=void 0,s=void 0,n=void 0,a=void 0,o=void 0;return"X"===t?(i=this.wrapperObj.scrollWidth,s=this.bars.horizontal.size,n=this.container.scrollWidth,a=this.container.elm.offsetLeft,o=e.clientX-this.dragging.offset):"Y"===t&&(i=this.wrapperObj.scrollHeight,s=this.bars.vertical.size,n=this.container.scrollHeight,a=this.container.elm.offsetTop-1.4*this.bars.vertical.size,o=e.clientY-this.dragging.offset),(i-n)*(o-a)/(n-s)},startDrag:function(e){e.preventDefault(),e.stopPropagation();var t=(e=e.changedTouches?e.changedTouches[0]:e).target.getAttribute("data-axis"),i=e.target.getAttribute("data-drag-source"),s=void 0;"Y"===t?"bar"===i?s=e.explicitOriginalTarget.offsetTop+1.4*this.bars.vertical.size:"internal"===i&&(s=e.clientY-this.bars.vertical.elm.offsetTop):"X"===t&&("bar"===i?s=e.explicitOriginalTarget.offsetLeft+1.4*this.bars.horizontal.size:"internal"===i&&(s=e.clientX-this.bars.horizontal.elm.offsetLeft)),this.dragging={enable:!0,axis:t,offset:s}},getWrapper:function(){return this.$refs.wrapperRef},scrollTo:function(e,t){var i=this.getWrapper();i.scrollLeft=e,i.scrollTop=t,this.getSizes()},onDrag:function(e){var t;this.dragging.enable&&(e.preventDefault(),e.stopPropagation(),e=e.changedTouches?e.changedTouches[0]:e,t=this.$refs.wrapperRef,"X"===this.dragging.axis?t.scrollLeft=this.getCoordinates(e,"X"):"Y"===this.dragging.axis&&(t.scrollTop=this.getCoordinates(e,"Y")),this.getSizes())},stopDrag:function(){this.dragging.enable&&(this.dragging={enable:!1,axis:""})},getSizes:function(){var e=this.$refs.wrapperRef,t=this.$refs.container,i=this.$refs.verticalBar,s=this.$refs.verticalInternalBar,n=this.$refs.horizontalBar,a=this.$refs.horizontalInternalBar;this.wrapperObj={elm:e,scrollHeight:e.scrollHeight,scrollWidth:e.scrollWidth,scrollLeft:e.scrollLeft,scrollTop:e.scrollTop},this.container={elm:t,scrollHeight:t.scrollHeight,scrollWidth:t.scrollWidth},this.bars.horizontal.elm=a,this.bars.horizontal.parent=n,this.bars.horizontal.size=24<this.wrapperObj.scrollWidth-this.container.scrollWidth&&this.wrapperObj.scrollWidth-this.container.scrollWidth!=0?this.container.scrollWidth/this.wrapperObj.scrollWidth*this.container.scrollWidth:0,this.bars.vertical.elm=s,this.bars.vertical.parent=i,this.bars.vertical.size=24<this.wrapperObj.scrollHeight-this.container.scrollHeight&&this.wrapperObj.scrollHeight-this.container.scrollHeight!=0?this.container.scrollHeight/this.wrapperObj.scrollHeight*this.container.scrollHeight:0}},props:["wrapper","vBar","vBarInternal","hBar","hBarInternal"],template:'<div id="vbar" :class="propWrapperSize"> <div class="bar--container" ref="container" @wheel="scroll" @touchmove="scroll" :style="shadowStyle"> <div class="bar--vertical" ref="verticalBar" v-show="bars.vertical.size" :style="barSizeVertical" :class="propBarVertical" @touchstart="startDrag" @mousedown="startDrag" data-axis="Y" data-drag-source="bar"> <div class="bar--vertical-internal" ref="verticalInternalBar" :style="barInternalVertical" :class="propBarInternalVertical" @touchstart="startDrag" @mousedown="startDrag" data-axis="Y" data-drag-source="internal"></div> </div> <div class="bar--horizontal" ref="horizontalBar" v-show="bars.horizontal.size" :style="barSizeHorizontal" :class="propBarHorizontal" @touchstart="startDrag" @mousedown="startDrag" data-axis="X" data-drag-source="bar"> <div class="bar--horizontal-internal" ref="horizontalInternalBar" :style="barInternalHorizontal" :class="propBarInternalHorizontal" @touchstart="startDrag" @mousedown="startDrag" data-axis="X" data-drag-source="internal"></div> </div> <div class="bar--wrapper" ref="wrapperRef" :style="validationScrolls"> <slot></slot> </div> </div> </div>'}),window.$app.defineModule("frontend",[{path:"/",props:!0,component:"vue-frontend-index",children:[{path:"/:username",props:!0,name:"index",component:"vue-frontend-page"},{path:"/:username/",props:!0,name:"inner",component:{template:"<keep-alive><router-view></router-view></keep-alive>"},children:[{path:"p/:page_id/",component:"vue-frontend-page",props:!0,name:"page"},{path:":part/",component:"vue-frontend-page",props:!0,name:"part.index"},{path:":part/:page_id/",component:"vue-frontend-page",props:!0,name:"part"}]}]}]);
